
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://elblo.github.io/dwes2526/09actividadesResueltas.html">
      
      
      
      
      <link rel="icon" href="imagenes/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Laravel Avanzado: Actividades resueltas - Desarrollo Web en Entorno Servidor</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="Teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#laravel-avanzado-actividades-resueltas" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="index.html" title="Desarrollo Web en Entorno Servidor" class="md-header__button md-logo" aria-label="Desarrollo Web en Entorno Servidor" data-md-component="logo">
      
  <img src="imagenes/logoies.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Desarrollo Web en Entorno Servidor
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Laravel Avanzado: Actividades resueltas
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="Teal"  aria-label="Cambiar a modo noche"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo noche" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="Teal"  aria-label="Cambiar a modo día"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo día" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Desarrollo Web en Entorno Servidor" class="md-nav__button md-logo" aria-label="Desarrollo Web en Entorno Servidor" data-md-component="logo">
      
  <img src="imagenes/logoies.png" alt="logo">

    </a>
    Desarrollo Web en Entorno Servidor
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inicio
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="01arquitecturas.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.- Arquitecturas Web
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="02php.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.- El lenguaje PHP
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="03phpoo.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3.- PHP Orientado a Objetos
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="04web.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.- Programación Web
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="laravel-avanzado-actividades-resueltas">Laravel Avanzado: Actividades resueltas<a class="headerlink" href="#laravel-avanzado-actividades-resueltas" title="Permanent link">&para;</a></h1>
<p>A continuación, vas a realizar una serie de ejercicios sobre cada uno de los apartados vistos en el tema. Puedes crear un proyecto nuevo o reutilizar uno existente.</p>
<h3 id="manejo-de-ficheros">Manejo de ficheros<a class="headerlink" href="#manejo-de-ficheros" title="Permanent link">&para;</a></h3>
<p>Para practicar con los ficheros vas a crear una galería de imágenes con posibilidad de subir nuevas, eliminar y acceder a su vista en detalle. También vas a implementar un "Mini Drive" para gestionar archivos. En ambos casos, vas a trabajar sin modelos para centrarte exclusivamente en el manejo de ficheros, pero en una app real, además sería recomendable trabajar con una BDD que almacene la información necesaria de los archivos.</p>
<ol start="901">
<li><strong>Formulario de subida</strong>: Crea un formulario para subir una imagen. La ruta que lleva al formulario por GET será <code>imagen/create</code> y la vista del mismo será <code>imagen/create.blade.php</code>. El formulario se enviará por POST a la ruta <code>imagen/storage</code>. Además del propio input de la imagen, el formulario tendrá un radio button para seleccionar si la imagen se almacenará de forma privada o pública en el storage.</li>
</ol>
<details class="info">
<summary>Solución</summary>
<p>La ruta para abrir el formulario:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
</code></pre></div>
<p>La vista <code>imagen/create.blade.php</code> con el formulario de subida:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;{{ route(&#39;subir.imagen&#39;) }}&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;POST&quot;</span> <span class="na">enctype</span><span class="o">=</span><span class="s">&quot;multipart/form-data&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="2 "></span>    @csrf
<span class="linenos" data-linenos="3 "></span>    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;file&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;imagen&quot;</span> <span class="na">required</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="4 "></span>    <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span><span class="p">&gt;</span>Subir Imagen<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="5 "></span><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</code></pre></div>
</details>
<ol start="902">
<li><strong>Almacenar archivos</strong>: Crea la función correspondiente en el controlador para recibir la imagen del formulario anterior validando que sea del tipo imagen, requerida y con un tamaño máximo de 2MB. Y según la opción del formulario, almacena la imagen de forma privada o pública en el storage. Después redirecciona a la página anterior enviando un mensaje del tipo "Imagen NOMBRE almacenada correctamente en el storage privado|público" que mostrarás justo encima del formulario.</li>
</ol>
<details class="info">
<summary>Solución</summary>
<p>La función 'store' del controlador almacena la imagen en el directorio <code>storage/app/public/imagenes</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">use</span> <span class="nx">Illuminate\Http\Request</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">class</span> <span class="nc">ArchivoController</span> <span class="k">extends</span> <span class="nx">Controller</span>
<span class="linenos" data-linenos=" 5 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">subirImagen</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span>        <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">([</span>
<span class="linenos" data-linenos=" 9 "></span>            <span class="s1">&#39;imagen&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required|image|mimes:jpeg,png,jpg,gif,svg|max:2048&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="10 "></span>        <span class="p">]);</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span>        <span class="k">if</span> <span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">file</span><span class="p">(</span><span class="s1">&#39;imagen&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="linenos" data-linenos="13 "></span>            <span class="nv">$path</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">file</span><span class="p">(</span><span class="s1">&#39;imagen&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">store</span><span class="p">(</span><span class="s1">&#39;imagenes&#39;</span><span class="p">,</span> <span class="s1">&#39;public&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="14 "></span>            <span class="k">return</span> <span class="nx">back</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">with</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">,</span> <span class="s1">&#39;Imagen subida correctamente.&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">with</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="nv">$path</span><span class="p">);</span>
<span class="linenos" data-linenos="15 "></span>        <span class="p">}</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span>        <span class="k">return</span> <span class="nx">back</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">withErrors</span><span class="p">(</span><span class="s1">&#39;Error al subir la imagen.&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="18 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="19 "></span><span class="p">}</span>
</code></pre></div>
<p>Asegúrate de crear el enlace simbólico desde 'public' para que las imágenes sean accesibles públicamente. Ve a la raíz del proyecto y ejectua (sólo se hace una vez):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="go">php artisan storage:link</span>
</code></pre></div>
</details>
<ol start="903">
<li><strong>Mostrar archivos</strong>: Mediante la ruta por GET <code>imagen</code> que lleva a la vista <code>imagen/index.blade.php</code> muestra una galería con todas las imágenes en miniatura. Puedes utilizar flexbox o grid layout para posicionarlas unas al lado de las otras. <strong>Importante</strong>: No olvides crear el enlace simbólico para poder acceder a las imágenes. Crea un enlace "Subir imagen" que lleve al formulario del primer punto y en dicho formulario, un enlace para volver aquí, al listado.</li>
</ol>
<details class="info">
<summary>Solución</summary>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
</code></pre></div>
</details>
<ol start="904">
<li><strong>Mostrar imagen completa</strong>: Mediante la ruta por GET <code>imagen/{name}</code> que lleva a la vista <code>imagen/show.blade.php</code> muestra la vista en tamaño completo de la imagen. Muestra un párrafo con su ruta completa y un enlace para volver al listado.</li>
</ol>
<details class="info">
<summary>Solución</summary>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
</code></pre></div>
</details>
<ol start="905">
<li><strong>Eliminar archivos</strong>: Mediante la ruta por GET <code>imagen/{name}/destroy</code> elimina la imagen que corresponda. A esta ruta podrás llegar mediante un enlace de la vista en detalle de la imagen. Una vez eliminada, se redirige automáticamente al listado enviando con 'with' un mensaje del tipo "Imagen NOMBRE eliminada correctamente del storage público".</li>
</ol>
<details class="info">
<summary>Solución</summary>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">use</span> <span class="nx">Illuminate\Support\Facades\Storage</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">public</span> <span class="k">function</span> <span class="nf">eliminarImagen</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)</span>
<span class="linenos" data-linenos=" 5 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="nv">$path</span> <span class="o">=</span> <span class="s1">&#39;imagenes/&#39;</span> <span class="o">.</span> <span class="nv">$filename</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="k">if</span> <span class="p">(</span><span class="nx">Storage</span><span class="o">::</span><span class="na">disk</span><span class="p">(</span><span class="s1">&#39;public&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">exists</span><span class="p">(</span><span class="nv">$path</span><span class="p">))</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="nx">Storage</span><span class="o">::</span><span class="na">disk</span><span class="p">(</span><span class="s1">&#39;public&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>
<span class="linenos" data-linenos="10 "></span>        <span class="k">return</span> <span class="nx">back</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">with</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">,</span> <span class="s1">&#39;Imagen eliminada correctamente.&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="11 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span>    <span class="k">return</span> <span class="nx">back</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">withErrors</span><span class="p">(</span><span class="s1">&#39;El archivo no existe.&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="14 "></span><span class="p">}</span>
</code></pre></div>
<p>Con la ruta:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="nx">Route</span><span class="o">::</span><span class="na">delete</span><span class="p">(</span><span class="s1">&#39;/eliminar-imagen/{filename}&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">ArchivoController</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;eliminarImagen&#39;</span><span class="p">]);</span>
</code></pre></div>
</details>
<ol start="906">
<li><strong>Almacenamiento en S3</strong> (opcional): Con tu cuenta de estudiante de AWS, crea un bucket S3 con acceso público. Configura el proyecto actual para utilizar el disco 's3' por defecto o bien utilízalo de forma explícita en cada interacciíon que realices con el Storage.</li>
</ol>
<details class="info">
<summary>Solución</summary>
<p>Crea el bucket S3 en AWS y configura en <code>.env</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>AWS_ACCESS_KEY_ID=your-access-key-id
<span class="linenos" data-linenos="2 "></span>AWS_SECRET_ACCESS_KEY=your-secret-access-key
<span class="linenos" data-linenos="3 "></span>AWS_DEFAULT_REGION=your-region
<span class="linenos" data-linenos="4 "></span>AWS_BUCKET=your-bucket-name   
</code></pre></div>
<p>Asegúrate que en <code>config/filesystems.php</code> tengas configurado el disco 's3':</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="s1">&#39;s3&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
<span class="linenos" data-linenos="3 "></span>    <span class="s1">&#39;driver&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;s3&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="4 "></span>    <span class="s1">&#39;key&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;AWS_ACCESS_KEY_ID&#39;</span><span class="p">),</span>
<span class="linenos" data-linenos="5 "></span>    <span class="s1">&#39;secret&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;AWS_SECRET_ACCESS_KEY&#39;</span><span class="p">),</span>
<span class="linenos" data-linenos="6 "></span>    <span class="s1">&#39;region&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;AWS_DEFAULT_REGION&#39;</span><span class="p">),</span>
<span class="linenos" data-linenos="7 "></span>    <span class="s1">&#39;bucket&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;AWS_BUCKET&#39;</span><span class="p">),</span>
<span class="linenos" data-linenos="8 "></span>    <span class="s1">&#39;url&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;AWS_URL&#39;</span><span class="p">),</span>
<span class="linenos" data-linenos="9 "></span><span class="p">],</span>
</code></pre></div>
<p>Ahora, en la función 'store' del controlador deberás indicar que se almacene en el disco 's3':</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">public</span> <span class="k">function</span> <span class="nf">subirImagen</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
<span class="linenos" data-linenos=" 3 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">([</span>
<span class="linenos" data-linenos=" 5 "></span>        <span class="s1">&#39;imagen&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required|image|mimes:jpeg,png,jpg,gif,svg|max:2048&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="p">]);</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="k">if</span> <span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">file</span><span class="p">(</span><span class="s1">&#39;imagen&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="nv">$path</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">file</span><span class="p">(</span><span class="s1">&#39;imagen&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">store</span><span class="p">(</span><span class="s1">&#39;imagenes&#39;</span><span class="p">,</span> <span class="s1">&#39;s3&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="10 "></span>        <span class="k">return</span> <span class="nx">back</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">with</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">,</span> <span class="s1">&#39;Imagen subida correctamente.&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">with</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="nv">$path</span><span class="p">);</span>
<span class="linenos" data-linenos="11 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span>    <span class="k">return</span> <span class="nx">back</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">withErrors</span><span class="p">(</span><span class="s1">&#39;Error al subir la imagen.&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="14 "></span><span class="p">}</span>
</code></pre></div>
</details>
<ol start="907">
<li><strong>Mini Drive</strong>: De forma similar a lo que acabas de hacer con la galería, crea un sistema de almecenamiento de archivos que admita archivos de diferente tipo (imágenes, videos, documentos...). Deberás mostrar un listado con un icono según el tipo de archivo, su nombre, tamaño y opciones (eliminar), un formulario para subirlo con un campo en el que recojas el nombre con el que almacennarlo. Y en vez de la vista en detalle, al pulsar sobre el archivo en la vista del listado, se descargará directamente. Sigue las recomendaciones de los puntos anteriores.</li>
</ol>
<details class="info">
<summary>Solución</summary>
<p>En la función 'store' del formulario ahora deberás cambiar el nombre del archivo conservando su extensión mediante <em>getClientOriginalExtension()</em>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">public</span> <span class="k">function</span> <span class="nf">subirImagen</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
<span class="linenos" data-linenos=" 3 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">([</span>
<span class="linenos" data-linenos=" 5 "></span>        <span class="s1">&#39;imagen&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required|image|mimes:jpeg,png,jpg,gif,svg|max:2048&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="p">]);</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="k">if</span> <span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">file</span><span class="p">(</span><span class="s1">&#39;imagen&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="nv">$nombreArchivo</span> <span class="o">=</span> <span class="nb">time</span><span class="p">()</span> <span class="o">.</span> <span class="s1">&#39;.&#39;</span> <span class="o">.</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">file</span><span class="p">(</span><span class="s1">&#39;imagen&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">getClientOriginalExtension</span><span class="p">();</span>
<span class="linenos" data-linenos="10 "></span>        <span class="nv">$path</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">file</span><span class="p">(</span><span class="s1">&#39;imagen&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">storeAs</span><span class="p">(</span><span class="s1">&#39;imagenes&#39;</span><span class="p">,</span> <span class="nv">$nombreArchivo</span><span class="p">,</span> <span class="s1">&#39;public&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="11 "></span>        <span class="k">return</span> <span class="nx">back</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">with</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">,</span> <span class="s1">&#39;Imagen subida correctamente.&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">with</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="nv">$path</span><span class="p">);</span>
<span class="linenos" data-linenos="12 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span>    <span class="k">return</span> <span class="nx">back</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">withErrors</span><span class="p">(</span><span class="s1">&#39;Error al subir la imagen.&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="15 "></span><span class="p">}</span>
</code></pre></div>
</details>
<ol start="908">
<li><strong>Mini Drive con directorios</strong> (opcional): Investiga cómo crear directorios y mover archivos entre ellos. Ofrece en la interfaz que has creado, las opciones correspondientes para crear un nuevo directorio, para cambiar el nombre a un archivo (si no existe uno ya con dicho nombre) y moverlo a un directorio determinado. </li>
</ol>
<details class="info">
<summary>Solución</summary>
<p>Crear un nuevo directorio:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="c1">// En el controlador</span>
<span class="linenos" data-linenos="3 "></span><span class="k">use</span> <span class="nx">Illuminate\Support\Facades\Storage</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span>
<span class="linenos" data-linenos="5 "></span><span class="nx">Storage</span><span class="o">::</span><span class="na">makeDirectory</span><span class="p">(</span><span class="s1">&#39;public/nueva_carpeta&#39;</span><span class="p">);</span>
</code></pre></div>
<p>Si no tienes creado el enlace simbólico desde 'public', ve a la raíz del proyecto y ejectua (sólo se hace una vez):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="go">php artisan storage:link</span>
</code></pre></div>
<p>Ya es accesible la carpeta desde <code>http://tu-sitio.test/storage/nueva_carpeta</code>.</p>
<p>Mover archivos entre directorios:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">public</span> <span class="k">function</span> <span class="nf">moverArchivo</span><span class="p">(</span><span class="nv">$filename</span><span class="p">)</span>
<span class="linenos" data-linenos=" 3 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="nv">$pathOrigen</span> <span class="o">=</span> <span class="s1">&#39;imagenes/&#39;</span> <span class="o">.</span> <span class="nv">$filename</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="nv">$pathDestino</span> <span class="o">=</span> <span class="s1">&#39;archivos/&#39;</span> <span class="o">.</span> <span class="nv">$filename</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="k">if</span> <span class="p">(</span><span class="nx">Storage</span><span class="o">::</span><span class="na">disk</span><span class="p">(</span><span class="s1">&#39;public&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">exists</span><span class="p">(</span><span class="nv">$pathOrigen</span><span class="p">))</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span>        <span class="nx">Storage</span><span class="o">::</span><span class="na">disk</span><span class="p">(</span><span class="s1">&#39;public&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">move</span><span class="p">(</span><span class="nv">$pathOrigen</span><span class="p">,</span> <span class="nv">$pathDestino</span><span class="p">);</span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="k">return</span> <span class="nx">back</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">with</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">,</span> <span class="s1">&#39;Archivo movido correctamente.&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="10 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span>    <span class="k">return</span> <span class="nx">back</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">withErrors</span><span class="p">(</span><span class="s1">&#39;El archivo no existe.&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="13 "></span><span class="p">}</span>
</code></pre></div>
<p>La ruta en <code>web.php</code> sería así:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="nx">Route</span><span class="o">::</span><span class="na">post</span><span class="p">(</span><span class="s1">&#39;/mover-archivo/{filename}&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">ArchivoController</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;moverArchivo&#39;</span><span class="p">]);</span>
</code></pre></div>
</details>
<h3 id="request-y-response">Request y response<a class="headerlink" href="#request-y-response" title="Permanent link">&para;</a></h3>
<p>En los siguientes ejercicios vas a trabajar con <code>Request</code>y <code>Response</code> en las funciones de los controladores. El primero ya lo has utilizado para recoger los datos recibidos de un formulario. Vas a repasar su uso y sobre todo, vas a conocer el segundo.</p>
<ol start="910">
<li><strong>Obtener y validar datos con Request</strong>: Crea un pequeño formulario para recoger "Nombre" y "Email" del usuario. Recoge sus datos en una función del controlador y valídalos. Si pasan la validación, símplemente devuelve un mensaje "Se ha pasado la validación" y si no, captura los errores en la vista del formulario.</li>
</ol>
<details class="info">
<summary>Solución</summary>
<p>Función en el controlador para obtener los datos del formulario:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">use</span> <span class="nx">Illuminate\Http\Request</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">class</span> <span class="nc">UsuarioController</span> <span class="k">extends</span> <span class="nx">Controller</span>
<span class="linenos" data-linenos=" 5 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">guardar</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span>        <span class="nv">$validated</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">([</span>
<span class="linenos" data-linenos=" 9 "></span>            <span class="s1">&#39;nombre&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required|string|max:255&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="10 "></span>            <span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required|email|unique:users,email&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="11 "></span>        <span class="p">]);</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span>        <span class="c1">// Si no pasa la validación, Laravel redirige al formulario con los errores</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span>        <span class="nv">$nombre</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">input</span><span class="p">(</span><span class="s1">&#39;nombre&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="16 "></span>        <span class="nv">$email</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">input</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span>        <span class="k">return</span> <span class="s2">&quot;Validación correcta: Nombre: </span><span class="si">$nombre</span><span class="s2">, Email: </span><span class="si">$email</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="19 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="20 "></span><span class="p">}</span>
</code></pre></div>
<p>En la vista del formulario, mostrar los errores:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span> @if ($errors-&gt;any())
<span class="linenos" data-linenos="2 "></span>    <span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="3 "></span>        @foreach ($errors-&gt;all() as $error)
<span class="linenos" data-linenos="4 "></span>            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>{{ $error }}<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="5 "></span>        @endforeach
<span class="linenos" data-linenos="6 "></span>    <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="7 "></span>@endif
</code></pre></div>
</details>
<ol start="911">
<li><strong>Redireccionar la respuesta</strong>: Modifica el ejercicio anterior para redireccionar la respuesta a otra ruta.</li>
</ol>
<details class="info">
<summary>Solución</summary>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">public</span> <span class="k">function</span> <span class="nf">guardar</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">){</span>
<span class="linenos" data-linenos="3 "></span>    <span class="c1">// ...</span>
<span class="linenos" data-linenos="4 "></span>    <span class="nv">$mensaje</span> <span class="o">=</span> <span class="s2">&quot;Validación correcta: Nombre: </span><span class="si">$nombre</span><span class="s2">, Email: </span><span class="si">$email</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="5 "></span>    <span class="k">return</span> <span class="nx">redirect</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">route</span><span class="p">(</span><span class="s1">&#39;contacto.gracias&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">with</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">,</span> <span class="nv">$mensaje</span><span class="p">);</span>
<span class="linenos" data-linenos="6 "></span><span class="p">}</span>
<span class="linenos" data-linenos="7 "></span>
<span class="linenos" data-linenos="8 "></span><span class="k">public</span> <span class="k">function</span> <span class="nf">gracias</span><span class="p">(){</span> <span class="k">return</span> <span class="nx">session</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">);</span> <span class="p">}</span>
</code></pre></div>
</details>
<ol start="912">
<li><strong>Respuesta JSON</strong>: Crea una ruta GET <code>/api/usuarios</code> que devuelva un array de usuarios (id, nombre, email) en formato JSON.</li>
</ol>
<details class="info">
<summary>Solución</summary>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">use</span> <span class="nx">Illuminate\Http\Request</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">class</span> <span class="nc">ApiController</span> <span class="k">extends</span> <span class="nx">Controller</span>
<span class="linenos" data-linenos=" 5 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">usuarios</span><span class="p">()</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span>        <span class="nv">$usuarios</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos" data-linenos=" 9 "></span>            <span class="p">[</span><span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;nombre&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Juan&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;juan@example.com&#39;</span><span class="p">],</span>
<span class="linenos" data-linenos="10 "></span>            <span class="p">[</span><span class="s1">&#39;id&#39;</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;nombre&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Ana&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ana@example.com&#39;</span><span class="p">],</span>
<span class="linenos" data-linenos="11 "></span>        <span class="p">];</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span>        <span class="k">return</span> <span class="nx">response</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">json</span><span class="p">(</span><span class="nv">$usuarios</span><span class="p">);</span>
<span class="linenos" data-linenos="14 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="15 "></span><span class="p">}</span>
</code></pre></div>
</details>
<ol start="913">
<li><strong>Respuesta JSON error</strong>: Crea una ruta GET <code>/api/error</code> que devuelva un array (error y mensaje) en formato JSON y además, el código de estado 400 para indicar al cliente que ha enviado una petición inválida.</li>
</ol>
<details class="info">
<summary>Solución</summary>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">public</span> <span class="k">function</span> <span class="nf">error</span><span class="p">()</span>
<span class="linenos" data-linenos="3 "></span><span class="p">{</span>
<span class="linenos" data-linenos="4 "></span>    <span class="k">return</span> <span class="nx">response</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">json</span><span class="p">([</span>
<span class="linenos" data-linenos="5 "></span>        <span class="s1">&#39;error&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Solicitud incorrecta&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="6 "></span>        <span class="s1">&#39;message&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Faltan datos en la solicitud.&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="7 "></span>    <span class="p">],</span> <span class="mi">400</span><span class="p">);</span>
<span class="linenos" data-linenos="8 "></span><span class="p">}</span>
</code></pre></div>
</details>
<ol start="914">
<li><strong>Modificar cabeceras de la respuesta</strong>: Crea una ruta GET <code>/archivo/descargar</code> que devuelva un archivo descargable y modifique los encabezados de la respuesta. En el controlador, usa <em>response()-&gt;download()</em> para devolver el archivo estableciendo un encabezado personalizado.</li>
</ol>
<details class="info">
<summary>Solución</summary>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">public</span> <span class="k">function</span> <span class="nf">descargar</span><span class="p">()</span>
<span class="linenos" data-linenos="3 "></span><span class="p">{</span>
<span class="linenos" data-linenos="4 "></span>    <span class="nv">$file</span> <span class="o">=</span> <span class="nx">public_path</span><span class="p">(</span><span class="s1">&#39;archivos/ejemplo.pdf&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="5 "></span>    <span class="k">return</span> <span class="nx">response</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">download</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span> <span class="s1">&#39;mi_archivo.pdf&#39;</span><span class="p">,</span> <span class="p">[</span>
<span class="linenos" data-linenos="6 "></span>        <span class="s1">&#39;Content-Type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;application/pdf&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="7 "></span>    <span class="p">]);</span>
<span class="linenos" data-linenos="8 "></span><span class="p">}</span>
</code></pre></div>
</details>
<ol start="915">
<li><strong>Ejercicio completo: API Rest</strong>: Con lo visto hasta ahora, implementa una API RESTful para manejar usuarios:</li>
</ol>
<ul>
<li><strong>C</strong>: Crear un usuario mediante POST <code>/api/usuarios</code>.</li>
<li><strong>R</strong>: Listar usuarios con GET <code>/api/usuarios</code>.</li>
<li><strong>U</strong>: Actualizar un usuario con PUT <code>/api/usuarios/{id}</code>.</li>
<li><strong>D</strong>: Eliminar un usuario con DELETE <code>/api/usuarios/{id}</code>.</li>
</ul>
<p>Asegúrate de devolver respuestas adecuadas en JSON y manejar los errores correctamente.</p>
<h3 id="eloquent-relaciones">Eloquent: Relaciones<a class="headerlink" href="#eloquent-relaciones" title="Permanent link">&para;</a></h3>
<p>En este apartado vas a crear diferentes relaciones entre modelos.</p>
<ol start="920">
<li><strong>Relación 1 a 1</strong>. </li>
</ol>
<ul>
<li>Crea los modelos <code>Usuario</code> y <code>Perfil</code>. Cada usuario tiene un perfil, y cada perfil pertenece a un único usuario.</li>
<li>En las migraciones asegúrate que las tablas tienen los siguientes campos:</li>
<li><code>usuarios</code>: campos <code>id</code>, <code>nombre</code>, <code>email</code>.</li>
<li><code>perfiles</code>: campos <code>id</code>, <code>usuario_id</code>, <code>telefono</code>, <code>direccion</code>.</li>
<li>Define la relación en los modelos.</li>
</ul>
<details class="info">
<summary>Solución</summary>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">// Modelo Usuario</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">use Illuminate\Database\Eloquent\Model;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">class Usuario extends Model{</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">    public function perfil(){</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">        return $this-&gt;hasOne(Perfil::class);</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">    }</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">}</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="x">// Modelo Perfil</span>
<span class="linenos" data-linenos="11 "></span><span class="x">use Illuminate\Database\Eloquent\Model;</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="x">class Perfil extends Model{</span>
<span class="linenos" data-linenos="14 "></span><span class="x">    public function usuario(){</span>
<span class="linenos" data-linenos="15 "></span><span class="x">        return $this-&gt;belongsTo(Usuario::class);</span>
<span class="linenos" data-linenos="16 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="17 "></span><span class="x">}</span>
</code></pre></div>
</details>
<ul>
<li>Rellena con 2 ó 3 registros manualmente o mediante Eloquent en ambas tablas/modelos.</li>
<li>Consulta los datos de un usuario y muestra su perfil. Para ello, crea una ruta <code>usuario/{id}</code> que redirija a la función <code>show</code> del controlador y llame a la vista <code>usuario.show.blade.php</code> para los datos del usuario con su perfil.</li>
</ul>
<details class="info">
<summary>Solución</summary>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">// En el controlador</span>
<span class="linenos" data-linenos="2 "></span><span class="x">public function show(string $id){</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    $usuario = Usuario::find($id);</span>
<span class="linenos" data-linenos="4 "></span><span class="x">    $perfil = $usuario-&gt;perfil; // También se podría recuperar el perfil en la vista</span>
<span class="linenos" data-linenos="5 "></span><span class="x">    return view(&#39;usuario.show&#39;, compact(&#39;usuario&#39;, &#39;perfil&#39;));</span>
<span class="linenos" data-linenos="6 "></span><span class="x">}</span>
</code></pre></div>
</details>
<ol start="921">
<li><strong>Relación 1 a Muchos</strong>. </li>
</ol>
<ul>
<li>Crea los modelos <code>Categoria</code> y <code>Producto</code>. Cada categoría tiene muchos productos, pero un producto sólo perteneca una determinada categoría.</li>
<li>En las migraciones asegúrate que las tablas tienen los siguientes campos:</li>
<li><code>categorias</code>: campos <code>id</code>, <code>nombre</code>.</li>
<li><code>productos</code>: campos <code>id</code>, <code>nombre</code>, <code>precio</code>, <code>categoria_id</code>.</li>
<li>Define la relación en los modelos.</li>
</ul>
<details class="info">
<summary>Solución</summary>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">// Modelo Categoria</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">use Illuminate\Database\Eloquent\Model;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">class Categoria extends Model{</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">    public function productos(){</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">        return $this-&gt;hasMany(Producto::class);</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">    }</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">}</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="x">// Modelo Prodcuto</span>
<span class="linenos" data-linenos="11 "></span><span class="x">use Illuminate\Database\Eloquent\Model;</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="x">class Producto extends Model{</span>
<span class="linenos" data-linenos="14 "></span><span class="x">    public function categoria(){</span>
<span class="linenos" data-linenos="15 "></span><span class="x">        return $this-&gt;belongsTo(Categoria::class);</span>
<span class="linenos" data-linenos="16 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="17 "></span><span class="x">}</span>
</code></pre></div>
</details>
<ul>
<li>Rellena con 2 ó 3 registros manualmente o mediante Eloquent en ambas tablas/modelos.</li>
<li>Consulta el nombre de una categoría mostrando sus productos. Para ello, crea una ruta <code>categoria/{id}</code> que redirija a la función <code>show</code> del controlador y llame a la vista <code>categoria.show.blade.php</code>.</li>
</ul>
<details class="info">
<summary>Solución</summary>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">// En el controlador</span>
<span class="linenos" data-linenos="2 "></span><span class="x">public function show(string $id){</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    $categoria = Categoria::find($id);</span>
<span class="linenos" data-linenos="4 "></span><span class="x">    $productos = $categoria-&gt;productos; // También se podría hacer esto en la vista</span>
<span class="linenos" data-linenos="5 "></span><span class="x">    return view(&#39;categoria.show&#39;, compact(&#39;categoria&#39;, &#39;productos&#39;));</span>
<span class="linenos" data-linenos="6 "></span><span class="x">}</span>
</code></pre></div>
</details>
<ul>
<li>Mediante Eloquent agrega un nuevo producto a la categoría con id pasado por parámetro. Para ello, crea una ruta <code>categoria/{id}/addproduct/{nombre}</code> que redirija a la función <code>addProduct</code> del controlador y redirija a la ruta <code>show</code> anterior que llama a la vista <code>categoria.show.blade.php</code>.</li>
</ul>
<details class="info">
<summary>Solución</summary>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">// En el controlador</span>
<span class="linenos" data-linenos="2 "></span><span class="x">public function addProduct(string $id, string $nombre){</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    $categoria = Categoria::find($id);</span>
<span class="linenos" data-linenos="4 "></span><span class="x">    $categoria-&gt;productos()-&gt;create([&#39;nombre&#39; =&gt; $nombre]);</span>
<span class="linenos" data-linenos="5 "></span>
<span class="linenos" data-linenos="6 "></span><span class="x">    return redirect()-&gt;route(&#39;categoria.show&#39;, [&#39;id&#39; =&gt; $id]);</span>
<span class="linenos" data-linenos="7 "></span><span class="x">}</span>
</code></pre></div>
</details>
<ol start="922">
<li><strong>Relación Muchos a Muchos</strong>. </li>
</ol>
<ul>
<li>Crea los modelos <code>Estudiante</code> y <code>Asignatura</code>. Cada estudiante puede estár matriculado en muchas asignaturas y una asignatura la cursan muchos estudiantes.</li>
<li>En las migraciones asegúrate que las tablas tienen los siguientes campos:</li>
<li><code>estudiantes</code>: campos <code>id</code>, <code>nombre</code>.</li>
<li><code>asignaturas</code>: campos <code>id</code>, <code>nombre</code>.</li>
<li><code>asignatura_estudiante</code> (tabla pivote): <code>estudiante_id</code>, <code>asignatura_id</code>.</li>
<li>Define la relación en los modelos.</li>
</ul>
<details class="info">
<summary>Solución</summary>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">// Modelo Estudiante</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">use Illuminate\Database\Eloquent\Model;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">class Estudiante extends Model{</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">    public function asignaturas(){</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">        return $this-&gt;belongsToMany(Asignatura::class);</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">    }</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">}</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="x">// Modelo Asignatura</span>
<span class="linenos" data-linenos="11 "></span><span class="x">use Illuminate\Database\Eloquent\Model;</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="x">class Asignatura extends Model{</span>
<span class="linenos" data-linenos="14 "></span><span class="x">    public function estudiantes(){</span>
<span class="linenos" data-linenos="15 "></span><span class="x">        return $this-&gt;belongsToMany(Estudiante::class);</span>
<span class="linenos" data-linenos="16 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="17 "></span><span class="x">}</span>
</code></pre></div>
</details>
<ul>
<li>Rellena con 2 ó 3 registros manualmente o mediante Eloquent en ambas tablas/modelos.</li>
<li>Consulta todas las asignaturas de un estudiante por su id. Para ello, crea una ruta <code>estudiante/{id}</code> que redirija a la función <code>show</code> del controlador y llame a la vista <code>estudiante.show.blade.php</code>.</li>
</ul>
<details class="info">
<summary>Solución</summary>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">// En el controlador</span>
<span class="linenos" data-linenos="2 "></span><span class="x">public function show(string $id){</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    $estudiante = Estudiante::find($id);</span>
<span class="linenos" data-linenos="4 "></span><span class="x">    $asignaturas = $estudiante-&gt;asignaturas; // También se podría hacer esto en la vista</span>
<span class="linenos" data-linenos="5 "></span><span class="x">    return view(&#39;estudiante.show&#39;, compact(&#39;estudiante&#39;, &#39;asignaturas&#39;));</span>
<span class="linenos" data-linenos="6 "></span><span class="x">}</span>
</code></pre></div>
</details>
<ul>
<li>Consulta ahora todos los estudiantes que cursen una asignatura por su id. Para ello, crea una ruta <code>asignatura/{id}</code> que redirija a la función <code>show</code> del controlador y llame a la vista <code>asignatura.show.blade.php</code>.</li>
</ul>
<details class="info">
<summary>Solución</summary>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">// En el controlador</span>
<span class="linenos" data-linenos="2 "></span><span class="x">public function show(string $id){</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    $asignatura = Asignatura::find($id);</span>
<span class="linenos" data-linenos="4 "></span><span class="x">    $estudiantes = $asignatura-&gt;estudiantes; // También se podría hacer esto en la vista</span>
<span class="linenos" data-linenos="5 "></span><span class="x">    return view(&#39;asignatura.show&#39;, compact(&#39;asignatura&#39;, &#39;estudiantes&#39;));</span>
<span class="linenos" data-linenos="6 "></span><span class="x">}</span>
</code></pre></div>
</details>
<ul>
<li>Mediante Eloquent matricula a un estudiante en un curso determinado. Para ello, crea una ruta <code>estudiante/{id}/matricula/{idCurso}</code> que redirija a la función <code>matricula</code> del controlador y redirija a la ruta <code>show</code> de estudiante que llama a la vista <code>estudiante.show.blade.php</code>.</li>
</ul>
<details class="info">
<summary>Solución</summary>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">// En el controlador</span>
<span class="linenos" data-linenos="2 "></span><span class="x">public function matricula(string $id, string $idCurso){</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    $estudiante = Estudiante::find($id);</span>
<span class="linenos" data-linenos="4 "></span><span class="x">    $estudiante-&gt;cursos()-&gt;attach($idCurso);</span>
<span class="linenos" data-linenos="5 "></span>
<span class="linenos" data-linenos="6 "></span><span class="x">    return redirect()-&gt;route(&#39;estudiante.show&#39;, [&#39;id&#39; =&gt; $id]);</span>
<span class="linenos" data-linenos="7 "></span><span class="x">}</span>
</code></pre></div>
</details>
<ul>
<li>Mediante Eloquent desmatricula a un estudiante en un curso determinado. Para ello, crea una ruta <code>estudiante/{id}/desmatricula/{idCurso}</code> que redirija a la función <code>desmatricula</code> del controlador y redirija a la ruta <code>show</code> de estudiante que llama a la vista <code>estudiante.show.blade.php</code>.</li>
</ul>
<details class="info">
<summary>Solución</summary>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">// En el controlador</span>
<span class="linenos" data-linenos="2 "></span><span class="x">public function desmatricula(string $id, string $idCurso){</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    $estudiante = Estudiante::find($id);</span>
<span class="linenos" data-linenos="4 "></span><span class="x">    $estudiante-&gt;cursos()-&gt;detach($idCurso);</span>
<span class="linenos" data-linenos="5 "></span>
<span class="linenos" data-linenos="6 "></span><span class="x">    return redirect()-&gt;route(&#39;estudiante.show&#39;, [&#39;id&#39; =&gt; $id]);</span>
<span class="linenos" data-linenos="7 "></span><span class="x">}</span>
</code></pre></div>
</details>
<ol start="923">
<li><strong>Ejercicio completo</strong>: CRUD con varias relaciones y formularios.</li>
</ol>
<ul>
<li>Implementa un sistema de gestión de posts con sus respectivos comentarios mediante los modelos <code>Autor</code>, <code>Post</code> y <code>Comentario</code>.</li>
<li>Piensa bien las relaciones a utilizar. Un autor puede escribir muchos posts y comentarios. Un post puede tener muchos comentarios. Un comentario sólo pertenece a un post y está escrito por un autor.</li>
<li>De un <em>autor</em> interesa saber su imagen, nombre y email.</li>
<li>De un <em>post</em> interesa saber su título, fecha y descripción.</li>
<li>De un <em>comentario</em> interesa saber su texto y fecha.</li>
<li>Crea los CRUDs necesarios para cada modelo con sus rutas específicas, controladores, vistas (con formularios)...</li>
</ul>
<h3 id="mutadores-y-accesores">Mutadores y accesores<a class="headerlink" href="#mutadores-y-accesores" title="Permanent link">&para;</a></h3>
<ol start="930">
<li><strong>Formatear nombres y convertir números</strong>: En el modelo <code>Producto</code> del ejercicio anterior, crea:</li>
</ol>
<ul>
<li>Un mutador que almacene el nombre en minúsculas y un accesor que los devuelva con la primera letra en mayúscula.</li>
<li>Un mutador que almacene el precio convertido a céntimos y un accesor que lo devuelva de nuevo en euros.</li>
</ul>
<details class="info">
<summary>Solución</summary>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">namespace App\Models;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">use Illuminate\Database\Eloquent\Model;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">use Illuminate\Database\Eloquent\Casts\Attribute;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">class Producto extends Model{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">    protected $fillable = [&#39;nombre&#39;, &#39;precio&#39;];</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">    protected function nombre(): Attribute{</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">        return Attribute::make(</span>
<span class="linenos" data-linenos="10 "></span><span class="x">            set: fn ($value) =&gt; strtolower($value), // Guardar en minúsculas</span>
<span class="linenos" data-linenos="11 "></span><span class="x">            get: fn ($value) =&gt; ucfirst($value) // Devolver con la 1ª en mayúsculas</span>
<span class="linenos" data-linenos="12 "></span><span class="x">        );</span>
<span class="linenos" data-linenos="13 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="x">    protected function precio(): Attribute{</span>
<span class="linenos" data-linenos="16 "></span><span class="x">        return Attribute::make(</span>
<span class="linenos" data-linenos="17 "></span><span class="x">            set: fn ($value) =&gt; $value * 100, // Guardar en céntimos</span>
<span class="linenos" data-linenos="18 "></span><span class="x">            get: fn ($value) =&gt; $value / 100  // Devolver en euros</span>
<span class="linenos" data-linenos="19 "></span><span class="x">        );</span>
<span class="linenos" data-linenos="20 "></span><span class="x">    }</span>
<span class="linenos" data-linenos="21 "></span><span class="x">}</span>
</code></pre></div>
</details>
<ol start="931">
<li><strong>Slug automático</strong>: Un slug es una versión formateada de un texto, generalmente usada en URLs por gestores de contenidos. Un slug se crea eliminando caracteres especiales, convirtiendo espacios en guiones y pasando a minúsculas el texto. Por ejemplo: "Hola Mundo Laravel" tendría de slug "hola-mundo-laravel".</li>
</ol>
<p>En el modelo <code>Post</code> del ejercicio anterior:</p>
<ul>
<li>Crea la migración correspondiente para añadir el campo <code>slug</code> de tipo string.</li>
<li>Investiga cómo usar <code>Str::slug</code> para generar slugs.</li>
<li>Crea un mutador que convierta el título a slug y lo almacene en el campo <code>slug</code>.</li>
</ul>
<details class="info">
<summary>Solución</summary>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">namespace</span> <span class="nx">App\Models</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Model</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Casts\Attribute</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">use</span> <span class="nx">Illuminate\Support\Str</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="k">class</span> <span class="nc">Post</span> <span class="k">extends</span> <span class="nx">Model</span><span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="k">protected</span> <span class="nv">$fillable</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;titulo&#39;</span><span class="p">,</span> <span class="s1">&#39;fecha&#39;</span><span class="p">,</span> <span class="s1">&#39;descripcion&#39;</span><span class="p">,</span> <span class="s1">&#39;slug&#39;</span><span class="p">];</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span>    <span class="k">protected</span> <span class="k">function</span> <span class="nf">titulo</span><span class="p">()</span><span class="o">:</span> <span class="nx">Attribute</span><span class="p">{</span>
<span class="linenos" data-linenos="11 "></span>        <span class="k">return</span> <span class="nx">Attribute</span><span class="o">::</span><span class="na">make</span><span class="p">(</span>
<span class="linenos" data-linenos="12 "></span>            <span class="nx">set</span><span class="o">:</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="13 "></span>                <span class="k">return</span> <span class="p">[</span>
<span class="linenos" data-linenos="14 "></span>                    <span class="s1">&#39;titulo&#39;</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">,</span>
<span class="linenos" data-linenos="15 "></span>                    <span class="s1">&#39;slug&#39;</span> <span class="o">=&gt;</span> <span class="nx">Str</span><span class="o">::</span><span class="na">slug</span><span class="p">(</span><span class="nv">$value</span><span class="p">)</span>
<span class="linenos" data-linenos="16 "></span>                <span class="p">];</span>
<span class="linenos" data-linenos="17 "></span>            <span class="p">}</span>
<span class="linenos" data-linenos="18 "></span>        <span class="p">);</span>
<span class="linenos" data-linenos="19 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="20 "></span><span class="p">}</span>
</code></pre></div>
</details>
<ol start="932">
<li><strong>Formatear fechas de creación</strong>: En el modelo <code>Estudiante</code> del ejercicio anterior:</li>
</ol>
<ul>
<li>Investiga cómo usar la biblioteca <code>Carbon</code> para trabajar con fechas incluida en Laravel.</li>
<li>Crea un accesor que formatee la fecha de creación (created_at) en formato "d/m/Y - H:i".</li>
</ul>
<details class="info">
<summary>Solución</summary>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">namespace</span> <span class="nx">App\Models</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Model</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Casts\Attribute</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">use</span> <span class="nx">Carbon\Carbon</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="k">class</span> <span class="nc">Estudiante</span> <span class="k">extends</span> <span class="nx">Model</span><span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="k">protected</span> <span class="nv">$fillable</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">];</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span>    <span class="k">protected</span> <span class="k">function</span> <span class="nf">createdAt</span><span class="p">()</span><span class="o">:</span> <span class="nx">Attribute</span><span class="p">{</span>
<span class="linenos" data-linenos="11 "></span>        <span class="k">return</span> <span class="nx">Attribute</span><span class="o">::</span><span class="na">make</span><span class="p">(</span>
<span class="linenos" data-linenos="12 "></span>            <span class="nx">get</span><span class="o">:</span> <span class="nx">fn</span> <span class="p">(</span><span class="nv">$value</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">Carbon</span><span class="o">::</span><span class="na">parse</span><span class="p">(</span><span class="nv">$value</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">format</span><span class="p">(</span><span class="s1">&#39;d/m/Y - H:i&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos="13 "></span>        <span class="p">);</span>
<span class="linenos" data-linenos="14 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="15 "></span><span class="p">}</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span><span class="c1">// Uso en controlador o vista</span>
<span class="linenos" data-linenos="18 "></span><span class="k">echo</span> <span class="nv">$estudiante</span><span class="o">-&gt;</span><span class="na">created_at</span><span class="p">;</span> <span class="c1">// 04/02/2025 - 15:30</span>
</code></pre></div>
</details>
<h3 id="seeders-y-factories">Seeders y factories<a class="headerlink" href="#seeders-y-factories" title="Permanent link">&para;</a></h3>
<ol start="940">
<li><strong>Seeder básico</strong>: Crea un nuevo modelo <code>Usuario</code> con campos <code>nombre</code>, <code>email</code> y <code>password</code> (en su migración) y crea un seeder <code>UsuarioSeeder</code> que inserte 3 usuarios de prueba en la base de datos.</li>
</ol>
<details class="info">
<summary>Solución</summary>
<p>Ejecuta: <code>php artisan make:seeder UsuarioSeeder</code></p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">use</span> <span class="nx">App\Models\Usuario</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">use</span> <span class="nx">Illuminate\Database\Seeder</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">class</span> <span class="nc">UsuarioSeeder</span> <span class="k">extends</span> <span class="nx">Seeder</span>
<span class="linenos" data-linenos=" 6 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">run</span><span class="p">()</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="nx">Usuario</span><span class="o">::</span><span class="na">create</span><span class="p">([</span>
<span class="linenos" data-linenos="10 "></span>            <span class="s1">&#39;nombre&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Juan Pérez&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="11 "></span>            <span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;juan@example.com&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="12 "></span>            <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="nx">bcrypt</span><span class="p">(</span><span class="s1">&#39;password123&#39;</span><span class="p">),</span>
<span class="linenos" data-linenos="13 "></span>        <span class="p">]);</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span>        <span class="nx">Usuario</span><span class="o">::</span><span class="na">create</span><span class="p">([</span>
<span class="linenos" data-linenos="16 "></span>            <span class="s1">&#39;nombre&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Ana Gómez&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="17 "></span>            <span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;ana@example.com&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="18 "></span>            <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="nx">bcrypt</span><span class="p">(</span><span class="s1">&#39;password123&#39;</span><span class="p">),</span>
<span class="linenos" data-linenos="19 "></span>        <span class="p">]);</span>
<span class="linenos" data-linenos="20 "></span>
<span class="linenos" data-linenos="21 "></span>        <span class="nx">Usuario</span><span class="o">::</span><span class="na">create</span><span class="p">([</span>
<span class="linenos" data-linenos="22 "></span>            <span class="s1">&#39;nombre&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Adrián Lara&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="23 "></span>            <span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;adrian@example.com&#39;</span><span class="p">,</span>
<span class="linenos" data-linenos="24 "></span>            <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="nx">bcrypt</span><span class="p">(</span><span class="s1">&#39;password123&#39;</span><span class="p">),</span>
<span class="linenos" data-linenos="25 "></span>        <span class="p">]);</span>
<span class="linenos" data-linenos="26 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="27 "></span><span class="p">}</span>
</code></pre></div>
<p>Añadir al <code>DatabaseSeeder</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">DatabaseSeeder</span> <span class="k">extends</span> <span class="nx">Seeder</span>
<span class="linenos" data-linenos=" 3 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">run</span><span class="p">()</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">call</span><span class="p">([</span>
<span class="linenos" data-linenos=" 7 "></span>            <span class="nx">UsuarioSeeder</span><span class="o">::</span><span class="na">class</span><span class="p">,</span>
<span class="linenos" data-linenos=" 8 "></span>            <span class="c1">// ...</span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="p">]);</span>
<span class="linenos" data-linenos="10 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="11 "></span><span class="p">}</span>
</code></pre></div>
<p>Ejecuta: <code>php artisan db:seed --class=UsuarioSeeder</code></p>
</details>
<ol start="941">
<li><strong>Factoría con seeder</strong>: Crea una factoría <code>UsuarioFactory</code> con datos fake y en el seeder <code>UsuarioSeeder</code> crea 10 usuarios mediante la factoría.</li>
</ol>
<details class="info">
<summary>Solución</summary>
<p>Ejecuta: <code>php artisan make:factory UsuarioFactory -m Usuario</code></p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">namespace</span> <span class="nx">Database\Factories</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">use</span> <span class="nx">App\Models\Usuario</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Factories\Factory</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="k">class</span> <span class="nc">UsuarioFactory</span> <span class="k">extends</span> <span class="nx">Factory</span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="k">protected</span> <span class="nv">$model</span> <span class="o">=</span> <span class="nx">Usuario</span><span class="o">::</span><span class="na">class</span><span class="p">;</span> <span class="c1">// Se podría obviar </span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">definition</span><span class="p">()</span><span class="o">:</span> <span class="k">array</span><span class="p">{</span>
<span class="linenos" data-linenos="10 "></span>        <span class="k">return</span> <span class="p">[</span>
<span class="linenos" data-linenos="11 "></span>            <span class="s1">&#39;nombre&#39;</span> <span class="o">=&gt;</span> <span class="nv">$faker</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">,</span>
<span class="linenos" data-linenos="12 "></span>            <span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="nv">$faker</span><span class="o">-&gt;</span><span class="na">unique</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">safeEmail</span><span class="p">,</span>
<span class="linenos" data-linenos="13 "></span>            <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="nx">bcrypt</span><span class="p">(</span><span class="s1">&#39;password123&#39;</span><span class="p">),</span>
<span class="linenos" data-linenos="14 "></span>        <span class="p">];</span>
<span class="linenos" data-linenos="15 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="16 "></span><span class="p">}</span>
</code></pre></div>
<p>En el modelo <code>Usuario</code> añadir el trait <code>use HasFactory</code> para asociarlos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">class</span> <span class="nc">Usuario</span> <span class="k">extends</span> <span class="nx">Model</span><span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">use</span> <span class="nx">HasFactory</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span>    <span class="c1">// ...</span>
<span class="linenos" data-linenos="5 "></span><span class="p">}</span>
</code></pre></div>
<p>En el seeder <code>UsuarioSeeder</code> creado en el ejercicio anterior, añade:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">use</span> <span class="nx">App\Models\Usuario</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">use</span> <span class="nx">Illuminate\Database\Seeder</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">class</span> <span class="nc">UsuarioSeeder</span> <span class="k">extends</span> <span class="nx">Seeder</span>
<span class="linenos" data-linenos=" 6 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">run</span><span class="p">()</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="c1">// ...</span>
<span class="linenos" data-linenos="10 "></span>        <span class="nx">User</span><span class="o">::</span><span class="na">factory</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">();</span>
<span class="linenos" data-linenos="11 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="12 "></span><span class="p">}</span>
</code></pre></div>
<p>Ejecuta: <code>php artisan db:seed --class=UsuarioSeeder</code></p>
</details>
<ol start="942">
<li><strong>Seeders con modelos relacionados</strong>: Crea el modelo <code>Publicacion</code> con los campos <code>titulo</code>, <code>contenido</code> y <code>usuario_id</code> (en su migración) y modifica los modelos para que un usuario se relacione con muchas publicaciones. Crea las factorías <code>UsuarioFactory</code> (ya la tienes) y <code>PublicacionFactory</code> con datos fake para utilizar en el seeder <code>UsuarioPublicacionSeeder</code> para crear 10 usuarios que tentan entre 1 y 5 publicaciones cada uno.</li>
</ol>
<details class="info">
<summary>Solución</summary>
<p>Ejecuta: <code>php artisan make:factory PublicacionFactory -m Publicacion</code></p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">namespace</span> <span class="nx">Database\Factories</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">use</span> <span class="nx">App\Models\Publicacion</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Factories\Factory</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="k">class</span> <span class="nc">PublicacionFactory</span> <span class="k">extends</span> <span class="nx">Factory</span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="k">protected</span> <span class="nv">$model</span> <span class="o">=</span> <span class="nx">Publicacion</span><span class="o">::</span><span class="na">class</span><span class="p">;</span> <span class="c1">// Se podría obviar </span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">definition</span><span class="p">()</span><span class="o">:</span> <span class="k">array</span><span class="p">{</span>
<span class="linenos" data-linenos="10 "></span>        <span class="k">return</span> <span class="p">[</span>
<span class="linenos" data-linenos="11 "></span>            <span class="s1">&#39;titulo&#39;</span> <span class="o">=&gt;</span> <span class="nv">$faker</span><span class="o">-&gt;</span><span class="na">sentence</span><span class="p">,</span>
<span class="linenos" data-linenos="12 "></span>            <span class="s1">&#39;contenido&#39;</span> <span class="o">=&gt;</span> <span class="nv">$faker</span><span class="o">-&gt;</span><span class="na">paragraph</span><span class="p">,</span>
<span class="linenos" data-linenos="13 "></span>            <span class="s1">&#39;user_id&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">// Esto será modificado en el Seeder</span>
<span class="linenos" data-linenos="14 "></span>        <span class="p">];</span>
<span class="linenos" data-linenos="15 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="16 "></span><span class="p">}</span>
</code></pre></div>
<p>En el modelo <code>Publicacion</code> añadir el trait <code>use HasFactory</code> para asociarlos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">class</span> <span class="nc">Usuario</span> <span class="k">extends</span> <span class="nx">Model</span><span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">use</span> <span class="nx">HasFactory</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span>    <span class="c1">// ...</span>
<span class="linenos" data-linenos="5 "></span><span class="p">}</span>
</code></pre></div>
<p>Ejecuta: <code>php artisan make:seeder UsuarioPublicacionSeeder</code></p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">use</span> <span class="nx">App\Models\Usuario</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">use</span> <span class="nx">App\Models\Publicacion</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">use</span> <span class="nx">Illuminate\Database\Seeder</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="k">class</span> <span class="nc">UsuarioPublicacionSeeder</span> <span class="k">extends</span> <span class="nx">Seeder</span>
<span class="linenos" data-linenos=" 7 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">run</span><span class="p">()</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="p">{</span>
<span class="linenos" data-linenos="10 "></span>        <span class="c1">// Crear 10 usuarios</span>
<span class="linenos" data-linenos="11 "></span>        <span class="nx">User</span><span class="o">::</span><span class="na">factory</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">each</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nv">$user</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="12 "></span>            <span class="c1">// Crear entre 1 y 5 posts para cada usuario</span>
<span class="linenos" data-linenos="13 "></span>            <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">posts</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">createMany</span><span class="p">(</span><span class="nx">Post</span><span class="o">::</span><span class="na">factory</span><span class="p">(</span><span class="nb">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span><span class="o">-&gt;</span><span class="na">make</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">toArray</span><span class="p">());</span>
<span class="linenos" data-linenos="14 "></span>        <span class="p">});</span>
<span class="linenos" data-linenos="15 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="16 "></span><span class="p">}</span>
</code></pre></div>
<p>Añadir al <code>DatabaseSeeder</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">DatabaseSeeder</span> <span class="k">extends</span> <span class="nx">Seeder</span>
<span class="linenos" data-linenos=" 3 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">run</span><span class="p">()</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">call</span><span class="p">([</span>
<span class="linenos" data-linenos=" 7 "></span>            <span class="nx">UsuarioPublicacionSeeder</span><span class="o">::</span><span class="na">class</span><span class="p">,</span>
<span class="linenos" data-linenos=" 8 "></span>            <span class="c1">// ...</span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="p">]);</span>
<span class="linenos" data-linenos="10 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="11 "></span><span class="p">}</span>
</code></pre></div>
<p>Ejecuta: <code>php artisan db:seed --class=UsuarioPublicacionSeeder</code></p>
</details>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2025-2026 Eladio Blanco. Licencia CC BY-NC-SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/eladioblanco" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.2 4.2 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.52 8.52 0 0 1-5.33 1.84q-.51 0-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:<eladio.blanco@fernando3martos.com>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 12.13c-.15.01-.29.06-.39.17l-1 1 2.05 2 1-1c.22-.21.22-.56 0-.77l-1.24-1.23a.56.56 0 0 0-.38-.17m-2 1.75L13 19.94V22h2.06l6.06-6.07M20 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h7v-.89l8.24-8.22c.47-.49 1.12-.76 1.8-.76.34 0 .68.06 1 .19V6c0-1.12-.92-2-2.04-2m0 4-8 5-8-5V6l8 5 8-5"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": ".", "features": ["header.autohide", "toc.integrate", "content.tabs.link"], "search": "assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>