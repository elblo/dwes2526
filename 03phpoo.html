
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://elblo.github.io/dwes2526/03phpoo.html">
      
      
        <link rel="prev" href="02php.html">
      
      
        <link rel="next" href="04web.html">
      
      
      <link rel="icon" href="imagenes/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>3.- PHP Orientado a Objetos - Desarrollo Web en Entorno Servidor</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="Teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#php-orientado-a-objetos" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="index.html" title="Desarrollo Web en Entorno Servidor" class="md-header__button md-logo" aria-label="Desarrollo Web en Entorno Servidor" data-md-component="logo">
      
  <img src="imagenes/logoies.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Desarrollo Web en Entorno Servidor
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              3.- PHP Orientado a Objetos
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="Teal"  aria-label="Cambiar a modo noche"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo noche" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="Teal"  aria-label="Cambiar a modo día"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo día" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Desarrollo Web en Entorno Servidor" class="md-nav__button md-logo" aria-label="Desarrollo Web en Entorno Servidor" data-md-component="logo">
      
  <img src="imagenes/logoies.png" alt="logo">

    </a>
    Desarrollo Web en Entorno Servidor
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inicio
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="01arquitecturas.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1.- Arquitecturas Web
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="02php.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2.- El lenguaje PHP
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    3.- PHP Orientado a Objetos
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="03phpoo.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    3.- PHP Orientado a Objetos
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#31-clases-y-objetos" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 Clases y Objetos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#32-encapsulacion" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Encapsulación
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.2 Encapsulación">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recibirenviar-objetos" class="md-nav__link">
    <span class="md-ellipsis">
      Recibir/enviar objetos
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#33-constructor" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 Constructor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.3 Constructor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constructores-en-php-8" class="md-nav__link">
    <span class="md-ellipsis">
      Constructores en PHP 8
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#34-clases-estaticas" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 Clases estáticas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#35-introspeccion" class="md-nav__link">
    <span class="md-ellipsis">
      3.5 Introspección
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#36-herencia" class="md-nav__link">
    <span class="md-ellipsis">
      3.6 Herencia
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.6 Herencia">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sobreescribir-metodos" class="md-nav__link">
    <span class="md-ellipsis">
      Sobreescribir métodos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#constructor-en-hijos" class="md-nav__link">
    <span class="md-ellipsis">
      Constructor en hijos
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#37-clases-abstractas" class="md-nav__link">
    <span class="md-ellipsis">
      3.7 Clases abstractas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#38-clases-finales" class="md-nav__link">
    <span class="md-ellipsis">
      3.8 Clases finales
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#39-interfaces" class="md-nav__link">
    <span class="md-ellipsis">
      3.9 Interfaces
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#310-traits" class="md-nav__link">
    <span class="md-ellipsis">
      3.10 Traits
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#311-metodos-encadenados" class="md-nav__link">
    <span class="md-ellipsis">
      3.11 Métodos encadenados
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#312-metodos-magicos" class="md-nav__link">
    <span class="md-ellipsis">
      3.12 Métodos mágicos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#313-espacio-de-nombres" class="md-nav__link">
    <span class="md-ellipsis">
      3.13 Espacio de nombres
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.13 Espacio de nombres">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#justificacion" class="md-nav__link">
    <span class="md-ellipsis">
      Justificación
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#declaracion" class="md-nav__link">
    <span class="md-ellipsis">
      Declaración
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acceso" class="md-nav__link">
    <span class="md-ellipsis">
      Acceso
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#organizacion" class="md-nav__link">
    <span class="md-ellipsis">
      Organización
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autoload" class="md-nav__link">
    <span class="md-ellipsis">
      Autoload
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#314-gestion-de-errores" class="md-nav__link">
    <span class="md-ellipsis">
      3.14 Gestión de Errores
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#315-excepciones" class="md-nav__link">
    <span class="md-ellipsis">
      3.15 Excepciones
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.15 Excepciones">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crear-excepciones" class="md-nav__link">
    <span class="md-ellipsis">
      Crear excepciones
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#excepciones-multiples" class="md-nav__link">
    <span class="md-ellipsis">
      Excepciones múltiples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relanzar-excepciones" class="md-nav__link">
    <span class="md-ellipsis">
      Relanzar excepciones
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#316-spl" class="md-nav__link">
    <span class="md-ellipsis">
      3.16 SPL
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#317-referencias" class="md-nav__link">
    <span class="md-ellipsis">
      3.17 Referencias
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#318-actividades" class="md-nav__link">
    <span class="md-ellipsis">
      3.18 Actividades
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.18 Actividades">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objetos" class="md-nav__link">
    <span class="md-ellipsis">
      Objetos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proyecto-videoclub-10-teoria-hasta-interfaces" class="md-nav__link">
    <span class="md-ellipsis">
      Proyecto Videoclub 1.0 (teoría hasta interfaces)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proyecto-videoclub-20-teoria-hasta-el-final" class="md-nav__link">
    <span class="md-ellipsis">
      Proyecto Videoclub 2.0 (teoría hasta el final)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="04web.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.- Programación Web
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="php-orientado-a-objetos">PHP Orientado a Objetos<a class="headerlink" href="#php-orientado-a-objetos" title="Permanent link">&para;</a></h1>
<details class="abstract">
<summary>Duración y criterios de evaluación</summary>
<p>Duración estimada: 18 sesiones</p>
<hr />
<p>Resultado de aprendizaje:</p>
<ol start="5">
<li>Desarrolla aplicaciones Web identificando y aplicando mecanismos para separar el código de presentación de la lógica de negocio.</li>
</ol>
<p>Criterios de evaluación:</p>
<ol>
<li>Se han identificado las ventajas de separar la lógica de negocio de los aspectos de presentación de la aplicación. </li>
<li>Se han analizado tecnologías y mecanismos que permiten realizar esta separación y sus características principales. </li>
<li>Se han utilizado objetos y controles en el servidor para generar el aspecto visual de la aplicación web en el cliente. </li>
<li>Se han utilizado formularios generados de forma dinámica para responder a los eventos de la aplicación Web. </li>
<li>Se han escrito aplicaciones Web con mantenimiento de estado y separación de la lógica de negocio. </li>
<li>Se han aplicado los principios de la programación orientada a objetos. </li>
<li>Se ha probado y documentado el código.</li>
</ol>
</details>
<h2 id="31-clases-y-objetos">3.1 Clases y Objetos<a class="headerlink" href="#31-clases-y-objetos" title="Permanent link">&para;</a></h2>
<p>PHP sigue un paradigma de programación orientada a objetos (POO) basada en clases. </p>
<p>Un clase es un plantilla que define las propiedades y métodos para poder crear objetos. De este manera, un objeto es una instancia de una clase.</p>
<p>Tanto las propiedades como los métodos se definen con una visibilidad (quien puede acceder)</p>
<ul>
<li>Privado - <code>private</code>:  Sólo puede acceder la propia clase.</li>
<li>Protegido - <code>protected</code>: Sólo puede acceder la propia clase o sus descendientes.</li>
<li>Público - <code>public</code>: Puede acceder cualquier otra clase.</li>
</ul>
<p>Pero a diferencia de otros lenguajes como Java, no podemos indicar el nivel de visibilidad de la clase. En PHP, todas las clases son públicas por definición.</p>
<p>Para declarar una clase, se utiliza la palabra clave <code>class</code> seguido del nombre de la clase. Para instanciar un objeto a partir de la clase, se utiliza <code>new</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">class</span> <span class="nc">NombreClase</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>    <span class="c1">// propiedades </span>
<span class="linenos" data-linenos="4 "></span>    <span class="c1">// y métodos </span>
<span class="linenos" data-linenos="5 "></span><span class="p">}</span>
<span class="linenos" data-linenos="6 "></span>
<span class="linenos" data-linenos="7 "></span><span class="nv">$ob</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">NombreClase</span><span class="p">();</span>
</code></pre></div>
<div class="admonition important">
<p class="admonition-title">Clases con mayúscula</p>
<p>Todas las clases empiezan por letra mayúscula.</p>
</div>
<p>Cuando un proyecto crece, es normal modelar las clases mediante UML. La clases se representan mediante un cuadrado, separando el nombre, de las propiedades y los métodos:</p>
<p><img alt="UML" src="imagenes/03/uml.png" width="500" /></p>
<p>Una vez que hemos creado un objeto, se utiliza el operador <code>-&gt;</code> para acceder a una propiedad o un método:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">$objeto-&gt;propiedad;</span>
<span class="linenos" data-linenos="2 "></span><span class="x">$objeto-&gt;método(parámetros);</span>
</code></pre></div>
<p>Si desde dentro de la clase, queremos acceder a una propiedad o método de la misma clase, utilizaremos la referencia <code>$this</code>;</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">$this-&gt;propiedad;</span>
<span class="linenos" data-linenos="2 "></span><span class="x">$this-&gt;método(parámetros);  </span>
</code></pre></div>
<p>Así pues, como ejemplo, codificaríamos una persona en el fichero <code>Persona.php</code> como:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Persona </span><span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">private</span> <span class="nx">string</span> <span class="nv">$nombre</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">setNombre</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$nom</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nombre</span><span class="o">=</span><span class="nv">$nom</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">imprimir</span><span class="p">(){</span>
<span class="linenos" data-linenos="10 "></span>        <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nombre</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span>        <span class="k">echo</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="13 "></span><span class="p">}</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="nv">$bruno </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Persona</span><span class="p">();</span> <span class="c1">// creamos un objeto</span>
<span class="linenos" data-linenos="16 "></span><span class="nv">$bruno</span><span class="o">-&gt;</span><span class="na">setNombre</span><span class="p">(</span><span class="s2">&quot;Bruno Díaz&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="17 "></span><span class="nv">$bruno</span><span class="o">-&gt;</span><span class="na">imprimir</span><span class="p">();</span>
</code></pre></div>
<p>Aunque se pueden declarar varias clases en el mismo archivo, es una mala práctica. Así pues, cada fichero contedrá una sola clase, y se nombrará con el nombre de la clase.</p>
<div class="admonition info">
<p class="admonition-title">Constantes como atributos</p>
<p>Es posible definir una constante como atributo de una clase, pero ojo, que sólo es posible definir su tipo de dato a partir de PHP 8.3.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Producto </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos=" 3 "></span>    <span class="k">public</span> <span class="k">const</span> <span class="no">float</span> <span class="nx">IVA</span> <span class="o">=</span> <span class="mf">0.21</span><span class="p">;</span> <span class="c1">// Sin &quot;float&quot; para versiones &lt; PHP 8.3</span>
</span><span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">private</span> <span class="nx">string</span> <span class="nv">$nombre</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="k">private</span> <span class="nx">string</span> <span class="nv">$precio</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="c1">// ...</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">getPrecioConIva</span><span class="p">()</span><span class="o">:</span> <span class="nx">float </span><span class="p">{</span>
<span class="linenos" data-linenos="11 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">precio</span><span class="o">=</span><span class="nv">$nom</span> <span class="o">*</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">precio</span> <span class="o">*</span> <span class="nx">self</span><span class="o">::</span><span class="na">IVA</span><span class="p">);</span>
<span class="linenos" data-linenos="12 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="13 "></span><span class="p">}</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="c1">// MAIN...</span>
<span class="linenos" data-linenos="16 "></span><span class="k">echo</span> <span class="nx">Producto</span><span class="o">::</span><span class="na">IVA</span><span class="p">;</span>
</code></pre></div>
</div>
<h2 id="32-encapsulacion">3.2 Encapsulación<a class="headerlink" href="#32-encapsulacion" title="Permanent link">&para;</a></h2>
<p>Las propiedades se definen privadas o protegidas (si queremos que las clases heredadas puedan acceder).</p>
<p>Para cada propiedad, se añaden métodos públicos (<em>getter/setter</em>):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">public setPropiedad(tipo $param)</span>
<span class="linenos" data-linenos="2 "></span><span class="x">public getPropiedad() : tipo</span>
</code></pre></div>
<p>Las constantes se definen públicas para que sean accesibles por todos los recursos.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">MayorMenor </span><span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">private</span> <span class="nx">int</span> <span class="nv">$mayor</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">private</span> <span class="nx">int</span> <span class="nv">$menor</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">setMayor</span><span class="p">(</span><span class="nx">int </span><span class="nv">$may</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">mayor </span><span class="o">=</span> <span class="nv">$may</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">setMenor</span><span class="p">(</span><span class="nx">int </span><span class="nv">$men</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="11 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">menor </span><span class="o">=</span> <span class="nv">$men</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">getMayor</span><span class="p">()</span> <span class="o">:</span> <span class="nx">int </span><span class="p">{</span>
<span class="linenos" data-linenos="15 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">mayor</span><span class="p">;</span>
<span class="linenos" data-linenos="16 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">getMenor</span><span class="p">()</span> <span class="o">:</span> <span class="nx">int </span><span class="p">{</span>
<span class="linenos" data-linenos="19 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">menor</span><span class="p">;</span>
<span class="linenos" data-linenos="20 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="21 "></span><span class="p">}</span>
</code></pre></div>
<h3 id="recibirenviar-objetos">Recibir/enviar objetos<a class="headerlink" href="#recibirenviar-objetos" title="Permanent link">&para;</a></h3>
<p>Es recomendable indicarlo en el tipo de parámetros. Si el objeto puede devolver nulos se pone <code>?</code> delante del nombre de la clase.</p>
<div class="admonition important">
<p class="admonition-title">Objetos por referencia</p>
<p>Los objetos que se envían y reciben como parámetros siempre se pasan por referencia.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="hll"><span class="linenos" data-linenos=" 2 "></span><span class="k">function</span> <span class="nf">maymen</span><span class="p">(</span><span class="k">array</span> <span class="nv">$numeros</span><span class="p">)</span> <span class="o">:</span> <span class="o">?</span><span class="nx">MayorMenor </span><span class="p">{</span>
</span><span class="linenos" data-linenos=" 3 "></span>    <span class="nv">$a </span><span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nv">$numeros</span><span class="p">);</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="nv">$b </span><span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nv">$numeros</span><span class="p">);</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="nv">$result </span><span class="o">=</span> <span class="k">new</span> <span class="nx">MayorMenor</span><span class="p">();</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="nv">$result</span><span class="o">-&gt;</span><span class="na">setMayor</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="nv">$result</span><span class="o">-&gt;</span><span class="na">setMenor</span><span class="p">(</span><span class="nv">$b</span><span class="p">);</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span>    <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span><span class="p">}</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="nv">$resultado </span><span class="o">=</span>  <span class="nx">maymen</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">76</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">388</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">39</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">97</span><span class="p">,</span><span class="mi">22</span><span class="p">]);</span>
<span class="linenos" data-linenos="14 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;Mayor: &quot;</span><span class="o">.</span><span class="nv">$resultado</span><span class="o">-&gt;</span><span class="na">getMayor</span><span class="p">();</span>
<span class="linenos" data-linenos="15 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;Menor: &quot;</span><span class="o">.</span><span class="nv">$resultado</span><span class="o">-&gt;</span><span class="na">getMenor</span><span class="p">();</span>
</code></pre></div>
<h2 id="33-constructor">3.3 Constructor<a class="headerlink" href="#33-constructor" title="Permanent link">&para;</a></h2>
<p>El constructor de los objetos se define mediante el método mágico <code>__construct</code>.
Puede o no tener parámetros, pero sólo puede haber un único constructor.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Persona </span><span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">private</span> <span class="nx">string</span> <span class="nv">$nombre</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="hll"><span class="linenos" data-linenos=" 5 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$nom</span><span class="p">)</span> <span class="p">{</span>
</span><span class="linenos" data-linenos=" 6 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nombre</span> <span class="o">=</span> <span class="nv">$nom</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">imprimir</span><span class="p">(){</span>
<span class="linenos" data-linenos="10 "></span>      <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nombre</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span>      <span class="k">echo</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="13 "></span><span class="p">}</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="nv">$bruno </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Persona</span><span class="p">(</span><span class="s2">&quot;Bruno Díaz&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="16 "></span><span class="nv">$bruno</span><span class="o">-&gt;</span><span class="na">imprimir</span><span class="p">();</span>
</code></pre></div>
<h3 id="constructores-en-php-8">Constructores en PHP 8<a class="headerlink" href="#constructores-en-php-8" title="Permanent link">&para;</a></h3>
<p>Una de las grandes novedades que ofrece PHP 8 es la simplificación de los constructores con parámetros, lo que se conoce como <em>promoción de las propiedades del constructor</em>.</p>
<p>Para ello, en vez de tener que declarar las propiedades como privadas o protegidas, y luego dentro del constructor tener que asignar los parámetros a estás propiedades, el propio constructor promociona las propiedades.</p>
<p>Veámoslo mejor con un ejemplo. Imaginemos una clase <code>Punto</code> donde queramos almacenar sus coordenadas:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Punto</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">protected</span> <span class="nx">float</span> <span class="nv">$x</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">protected</span> <span class="nx">float</span> <span class="nv">$y</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">protected</span> <span class="nx">float</span> <span class="nv">$z</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span>
<span class="linenos" data-linenos=" 8 "></span>        <span class="nx">float</span> <span class="nv">$x</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="nx">float</span> <span class="nv">$y</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="linenos" data-linenos="10 "></span>        <span class="nx">float</span> <span class="nv">$z</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos" data-linenos="11 "></span>    <span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="12 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">x</span> <span class="o">=</span> <span class="nv">$x</span><span class="p">;</span>
<span class="linenos" data-linenos="13 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">y</span> <span class="o">=</span> <span class="nv">$y</span><span class="p">;</span>
<span class="linenos" data-linenos="14 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">z</span> <span class="o">=</span> <span class="nv">$z</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="16 "></span><span class="p">}</span>
</code></pre></div>
<p>En PHP 8, quedaría del siguiente modo (mucho más corto, lo que facilita su legibilidad):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">class</span> <span class="nc">Punto</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span>
<span class="linenos" data-linenos="4 "></span>        <span class="k">protected</span> <span class="nx">float</span> <span class="nv">$x</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="linenos" data-linenos="5 "></span>        <span class="k">protected</span> <span class="nx">float</span> <span class="nv">$y</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="linenos" data-linenos="6 "></span>        <span class="k">protected</span> <span class="nx">float</span> <span class="nv">$z</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="linenos" data-linenos="7 "></span>    <span class="p">)</span> <span class="p">{}</span>
<span class="linenos" data-linenos="8 "></span><span class="p">}</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Opciones no válidas en el constructor</p>
<p>Para inicializar las propiedades directamente en los parámetros del constructor, estas han de ser literales como números, cadenas, booleanos, null, o arrays simples. Cualquier otra cosa que implique lógica o llamadas a funciones debe ir en el cuerpo del constructor, como por ejemplo instanciar un objeto de otra clase.</p>
</div>
<div class="admonition info">
<p class="admonition-title">El orden importa</p>
<p>A la hora de codificar el orden de los elementos debe ser:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">declare</span><span class="p">(</span><span class="nx">strict_types</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">class</span> <span class="nc">NombreClase</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="c1">// propiedades</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="c1">// constructor</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="c1">// getters - setters</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span>    <span class="c1">// resto de métodos</span>
<span class="linenos" data-linenos="12 "></span><span class="p">}</span>
<span class="linenos" data-linenos="13 "></span><span class="cp">?&gt;</span>
</code></pre></div>
</div>
<h2 id="34-clases-estaticas">3.4 Clases estáticas<a class="headerlink" href="#34-clases-estaticas" title="Permanent link">&para;</a></h2>
<p>Son aquellas que tienen propiedades y/o métodos estáticos (también se conocen como <em>de clase</em>, por que su valor se comparte entre todas las instancias de la misma clase).</p>
<p>Se declaran con <code>static</code> y se referencian con <code>::</code>.</p>
<ul>
<li>Si queremos acceder a un método o atributo estático, o a una constante, se antepone el nombre de la clase: <code>Producto::nuevoProducto()</code> o <code>Producto::$numProductos</code>.</li>
<li>Si desde dentro de la clase queremos llamar a un método o atributo estático propio, o a una constante, se utiliza la referencia <code>self</code>: <code>self::nuevoProducto</code> o <code>self::$numProductos</code>.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Producto</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">const</span> <span class="no">IVA</span> <span class="o">=</span> <span class="mf">0.23</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">public</span> <span class="k">static</span> <span class="nv">$numProductos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">nuevoProducto</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span>        <span class="nx">self</span><span class="o">::</span><span class="nv">$numProductos</span><span class="o">++</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 9 "></span><span class="p">}</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="nx">Producto</span><span class="o">::</span><span class="na">nuevoProducto</span><span class="p">();</span>
<span class="linenos" data-linenos="12 "></span><span class="nv">$nProductos</span> <span class="o">=</span> <span class="nx">Producto</span><span class="o">::</span><span class="nv">$numProductos</span><span class="p">;</span>
<span class="linenos" data-linenos="13 "></span><span class="nv">$impuesto</span> <span class="o">=</span> <span class="nx">Producto</span><span class="o">::</span><span class="na">IVA</span><span class="p">;</span>
</code></pre></div>
<p>También podemos tener clases normales que tengan alguna propiedad estática:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Producto </span><span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">const</span> <span class="no">IVA </span><span class="o">=</span> <span class="mf">0.23</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">private</span> <span class="k">static</span> <span class="nv">$numProductos </span><span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">private</span> <span class="nv">$codigo</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nx">string </span><span class="nv">$cod</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span>        <span class="nx">self</span><span class="o">::</span><span class="nv">$numProductos</span><span class="o">++</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">codigo </span><span class="o">=</span> <span class="nv">$cod</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarResumen</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span>        <span class="k">return</span> <span class="s2">&quot;El producto &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">codigo</span><span class="o">.</span><span class="s2">&quot; es el número &quot;</span><span class="o">.</span><span class="nx">self</span><span class="o">::</span><span class="nv">$numProductos</span><span class="p">;</span>
<span class="linenos" data-linenos="14 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="15 "></span><span class="p">}</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span><span class="nv">$prod1 </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Producto</span><span class="p">(</span><span class="s2">&quot;PS5&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="18 "></span><span class="nv">$prod2 </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Producto</span><span class="p">(</span><span class="s2">&quot;XBOX Series X&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="19 "></span><span class="nv">$prod3 </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Producto</span><span class="p">(</span><span class="s2">&quot;Nintendo Switch&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="20 "></span><span class="k">echo</span> <span class="nv">$prod3</span><span class="o">-&gt;</span><span class="na">mostrarResumen</span><span class="p">();</span>
</code></pre></div>
<h2 id="35-introspeccion">3.5 Introspección<a class="headerlink" href="#35-introspeccion" title="Permanent link">&para;</a></h2>
<p>Al trabajar con clases y objetos, existen un conjunto de funciones ya definidas por el lenguaje que permiten obtener información sobre los objetos:</p>
<ul>
<li><code>instanceof</code>: permite comprobar si un objeto es de una determinada clase</li>
<li><code>get_class</code>: devuelve el nombre de la clase</li>
<li><code>get_declared_class</code>: devuelve un array con los nombres de las clases definidas en el script actual</li>
<li><code>class_alias</code>: crea un alias</li>
<li><code>class_exists</code> / <code>method_exists</code> / <code>property_exists</code>: <code>true</code> si la clase / método / propiedad está definida</li>
<li><code>get_class_methods</code> / <code>get_class_vars</code> / <code>get_object_vars</code>: Devuelve un array con los nombres de los métodos / propiedades de una clase / propiedades de un objeto que son accesibles desde dónde se hace la llamada.</li>
</ul>
<p>Un ejemplo de estas funciones puede ser el siguiente:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="nv">$p </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Producto</span><span class="p">(</span><span class="s2">&quot;PS5&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">if</span> <span class="p">(</span><span class="nv">$p instanceof Producto</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">echo</span> <span class="s2">&quot;Es un producto&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">echo</span> <span class="s2">&quot;La clase es &quot;</span><span class="o">.</span><span class="nb">get_class</span><span class="p">(</span><span class="nv">$p</span><span class="p">);</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="nb">class_alias</span><span class="p">(</span><span class="s2">&quot;Producto&quot;</span><span class="p">,</span> <span class="s2">&quot;Articulo&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="nv">$c </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Articulo</span><span class="p">(</span><span class="s2">&quot;Nintendo Switch&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="k">echo</span> <span class="s2">&quot;Un articulo es un &quot;</span><span class="o">.</span><span class="nb">get_class</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span>    <span class="nb">print_r</span><span class="p">(</span><span class="nb">get_class_methods</span><span class="p">(</span><span class="s2">&quot;Producto&quot;</span><span class="p">));</span>
<span class="linenos" data-linenos="12 "></span>    <span class="nb">print_r</span><span class="p">(</span><span class="nb">get_class_vars</span><span class="p">(</span><span class="s2">&quot;Producto&quot;</span><span class="p">));</span>
<span class="linenos" data-linenos="13 "></span>    <span class="nb">print_r</span><span class="p">(</span><span class="nb">get_object_vars</span><span class="p">(</span><span class="nv">$p</span><span class="p">));</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span>    <span class="k">if</span> <span class="p">(</span><span class="nb">method_exists</span><span class="p">(</span><span class="nv">$p</span><span class="p">,</span> <span class="s2">&quot;mostrarResumen&quot;</span><span class="p">))</span> <span class="p">{</span>
<span class="linenos" data-linenos="16 "></span>        <span class="nv">$p</span><span class="o">-&gt;</span><span class="na">mostrarResumen</span><span class="p">();</span>
<span class="linenos" data-linenos="17 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="18 "></span><span class="p">}</span>
</code></pre></div>
<div class="admonition caution">
<p class="admonition-title">Clonado</p>
<p>Al asignar dos objetos no se copian, se crea una nueva referencia. Si queremos una copia, hay que clonarlo mediante el método <code>clone(object) : object</code></p>
<p>Si queremos modificar el clonado por defecto, hay que definir el método mágico <code>__clone()</code> que se llamará después de copiar todas las propiedades.</p>
<p>Más información en <a href="https://www.php.net/manual/es/language.oop5.cloning.php">https://www.php.net/manual/es/language.oop5.cloning.php</a></p>
</div>
<h2 id="36-herencia">3.6 Herencia<a class="headerlink" href="#36-herencia" title="Permanent link">&para;</a></h2>
<p>PHP soporta herencia simple, de manera que una clase solo puede heredar de otra, no de dos clases a la vez. Para ello se utiliza la palabra clave <code>extends</code>. Si queremos que la clase A hereda de la clase B haremos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">class A extends B</span>
</code></pre></div>
<p>El hijo hereda los atributos y métodos públicos y protegidos.</p>
<div class="admonition warning">
<p class="admonition-title">Cada clase en un archivo</p>
<p>Como ya hemos comentado, deberíamos colocar cada clase en un archivo diferente para posteriormente utilizarlo mediante <code>include</code>. En los siguientes ejemplos los hemos colocado juntos para facilitar su legibilidad.</p>
</div>
<p>Por ejemplo, tenemos una clase <code>Producto</code> y una <code>Tv</code> que hereda de <code>Producto</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Producto</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">public</span> <span class="nv">$codigo</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">public</span> <span class="nv">$nombre</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">public</span> <span class="nv">$nombreCorto</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="k">public</span> <span class="nv">$PVP</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarResumen</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;Prod:&quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">codigo</span><span class="o">.</span><span class="s2">&quot;&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="11 "></span><span class="p">}</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="k">class</span> <span class="nc">Tv</span> <span class="k">extends</span> <span class="nx">Producto</span> <span class="p">{</span>
<span class="linenos" data-linenos="14 "></span>    <span class="k">public</span> <span class="nv">$pulgadas</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span>    <span class="k">public</span> <span class="nv">$tecnologia</span><span class="p">;</span>
<span class="linenos" data-linenos="16 "></span><span class="p">}</span>
</code></pre></div>
<p>Podemos utilizar las siguientes funciones para averiguar si hay relación entre dos clases:</p>
<ul>
<li><code>get_parent_class(object): string</code></li>
<li><code>is_subclass_of(object, string): bool</code></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="nv">$t</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Tv</span><span class="p">();</span>
<span class="linenos" data-linenos=" 3 "></span><span class="nv">$t</span><span class="o">-&gt;</span><span class="na">codigo</span> <span class="o">=</span> <span class="mi">33</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">if</span> <span class="p">(</span><span class="nv">$t</span> <span class="nx">instanceof</span> <span class="nx">Producto</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">echo</span> <span class="nv">$t</span><span class="o">-&gt;</span><span class="na">mostrarResumen</span><span class="p">();</span>
<span class="linenos" data-linenos=" 6 "></span><span class="p">}</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="nv">$padre</span> <span class="o">=</span> <span class="nb">get_parent_class</span><span class="p">(</span><span class="nv">$t</span><span class="p">);</span>
<span class="linenos" data-linenos=" 9 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;La clase padre es: &quot;</span> <span class="o">.</span> <span class="nv">$padre</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="nv">$objetoPadre</span> <span class="o">=</span> <span class="k">new</span> <span class="nv">$padre</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span><span class="k">echo</span> <span class="nv">$objetoPadre</span><span class="o">-&gt;</span><span class="na">mostrarResumen</span><span class="p">();</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="k">if</span> <span class="p">(</span><span class="nb">is_subclass_of</span><span class="p">(</span><span class="nv">$t</span><span class="p">,</span> <span class="s1">&#39;Producto&#39;</span><span class="p">))</span> <span class="p">{</span>
<span class="linenos" data-linenos="14 "></span>    <span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;Soy un hijo de Producto&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span><span class="p">}</span>
</code></pre></div>
<h3 id="sobreescribir-metodos">Sobreescribir métodos<a class="headerlink" href="#sobreescribir-metodos" title="Permanent link">&para;</a></h3>
<p>Podemos crear métodos en los hijos con el mismo nombre que el padre, cambiando su comportamiento.
Para invocar a los métodos del padre -&gt; <code>parent::nombreMetodo()</code></p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Tv</span> <span class="k">extends</span> <span class="nx">Producto</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>   <span class="k">public</span> <span class="nv">$pulgadas</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>   <span class="k">public</span> <span class="nv">$tecnologia</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span>   <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarResumen</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span>      <span class="k">parent</span><span class="o">::</span><span class="na">mostrarResumen</span><span class="p">();</span>
<span class="linenos" data-linenos=" 8 "></span>      <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;TV &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">tecnologia</span><span class="o">.</span><span class="s2">&quot; de &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">pulgadas</span><span class="o">.</span><span class="s2">&quot;&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span>   <span class="p">}</span>
<span class="linenos" data-linenos="10 "></span><span class="p">}</span>
</code></pre></div>
<h3 id="constructor-en-hijos">Constructor en hijos<a class="headerlink" href="#constructor-en-hijos" title="Permanent link">&para;</a></h3>
<p>En los hijos no se crea ningún constructor de manera automática. Por lo que si no lo hay, se invoca automáticamente al del padre. En cambio, si lo definimos en el hijo, hemos de invocar al del padre de manera explícita.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">PHP7</label><label for="__tabbed_1_2">PHP8</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Producto</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">public</span> <span class="nx">string</span> <span class="nv">$codigo</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$codigo</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">codigo</span> <span class="o">=</span> <span class="nv">$codigo</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarResumen</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos="10 "></span>        <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;Prod:&quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">codigo</span><span class="o">.</span><span class="s2">&quot;&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="12 "></span><span class="p">}</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span><span class="k">class</span> <span class="nc">Tv</span> <span class="k">extends</span> <span class="nx">Producto</span> <span class="p">{</span>
<span class="linenos" data-linenos="15 "></span>    <span class="k">public</span> <span class="nv">$pulgadas</span><span class="p">;</span>
<span class="linenos" data-linenos="16 "></span>    <span class="k">public</span> <span class="nv">$tecnologia</span><span class="p">;</span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nx">string </span><span class="nv">$codigo</span><span class="p">,</span> <span class="nx">int </span><span class="nv">$pulgadas</span><span class="p">,</span> <span class="nx">string </span><span class="nv">$tecnologia</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="19 "></span>        <span class="k">parent</span><span class="o">::</span><span class="na">__construct</span><span class="p">(</span><span class="nv">$codigo</span><span class="p">);</span>
<span class="linenos" data-linenos="20 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">pulgadas </span><span class="o">=</span> <span class="nv">$pulgadas</span><span class="p">;</span>
<span class="linenos" data-linenos="21 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">tecnologia </span><span class="o">=</span> <span class="nv">$tecnologia</span><span class="p">;</span>
<span class="linenos" data-linenos="22 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="23 "></span>
<span class="linenos" data-linenos="24 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarResumen</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos="25 "></span>        <span class="k">parent</span><span class="o">::</span><span class="na">mostrarResumen</span><span class="p">();</span>
<span class="linenos" data-linenos="26 "></span>        <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;TV &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">tecnologia</span><span class="o">.</span><span class="s2">&quot; de &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">pulgadas</span><span class="o">.</span><span class="s2">&quot;&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="27 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="28 "></span><span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Producto</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="k">private</span> <span class="nx">string</span> <span class="nv">$codigo</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarResumen</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>        <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;Prod:&quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">codigo</span><span class="o">.</span><span class="s2">&quot;&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">}</span>        
<span class="linenos" data-linenos=" 8 "></span><span class="p">}</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="k">class</span> <span class="nc">Tv</span> <span class="k">extends</span> <span class="nx">Producto</span> <span class="p">{</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span>
<span class="linenos" data-linenos="13 "></span>        <span class="nx">string </span><span class="nv">$codigo</span><span class="p">,</span>
<span class="linenos" data-linenos="14 "></span>        <span class="k">private</span> <span class="nx">int </span><span class="nv">$pulgadas</span><span class="p">,</span>
<span class="linenos" data-linenos="15 "></span>        <span class="k">private</span> <span class="nx">string </span><span class="nv">$tecnologia</span><span class="p">)</span>
<span class="linenos" data-linenos="16 "></span>    <span class="p">{</span>
<span class="linenos" data-linenos="17 "></span>        <span class="k">parent</span><span class="o">::</span><span class="na">__construct</span><span class="p">(</span><span class="nv">$codigo</span><span class="p">);</span>
<span class="linenos" data-linenos="18 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarResumen</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos="21 "></span>        <span class="k">parent</span><span class="o">::</span><span class="na">mostrarResumen</span><span class="p">();</span>
<span class="linenos" data-linenos="22 "></span>        <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;TV &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">tecnologia</span><span class="o">.</span><span class="s2">&quot; de &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">pulgadas</span><span class="o">.</span><span class="s2">&quot;&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="23 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="24 "></span><span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="37-clases-abstractas">3.7 Clases abstractas<a class="headerlink" href="#37-clases-abstractas" title="Permanent link">&para;</a></h2>
<p>Las clases abstractas obligan a heredar de una clase, ya que no se permite su instanciación. Se define mediante <code>abstract class NombreClase {</code>.<br />
Una clase abstracta puede contener propiedades y métodos no-abstractos, y/o métodos abstractos.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="c1">// Clase abstracta</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">abstract</span> <span class="k">class</span> <span class="nc">Producto </span><span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">private</span> <span class="nv">$codigo</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">getCodigo</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">codigo</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="c1">// Método abstracto</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="k">abstract</span> <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarResumen</span><span class="p">();</span>
<span class="linenos" data-linenos="10 "></span><span class="p">}</span>
</code></pre></div>
<p>Cuando una clase hereda de una clase abstracta, obligatoriamente debe implementar los métodos que tiene el padre marcados como abstractos.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Tv</span> <span class="k">extends</span> <span class="nx">Producto</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">public</span> <span class="nv">$pulgadas</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">public</span> <span class="nv">$tecnologia</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarResumen</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//obligado a implementarlo</span>
<span class="linenos" data-linenos=" 7 "></span>        <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;Código &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getCodigo</span><span class="p">()</span><span class="o">.</span><span class="s2">&quot;&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span>        <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;TV &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">tecnologia</span><span class="o">.</span><span class="s2">&quot; de &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">pulgadas</span><span class="o">.</span><span class="s2">&quot;&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="10 "></span><span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="nv">$t</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Tv</span><span class="p">();</span>
<span class="linenos" data-linenos="13 "></span><span class="k">echo</span> <span class="nv">$t</span><span class="o">-&gt;</span><span class="na">getCodigo</span><span class="p">();</span>
</code></pre></div>
<h2 id="38-clases-finales">3.8 Clases finales<a class="headerlink" href="#38-clases-finales" title="Permanent link">&para;</a></h2>
<p>Son clases opuestas a abstractas, ya que evitan que se pueda heredar una clase o método para sobreescribirlo.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Producto </span><span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">private</span> <span class="nv">$codigo</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">getCodigo</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">codigo</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="k">final</span> <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarResumen</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string </span><span class="p">{</span>
<span class="linenos" data-linenos="10 "></span>        <span class="k">return</span> <span class="s2">&quot;Producto &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">codigo</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="12 "></span><span class="p">}</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span><span class="c1">// No podremos heredar de Microondas</span>
<span class="linenos" data-linenos="15 "></span><span class="k">final</span> <span class="k">class</span> <span class="nc">Microondas extends Producto </span><span class="p">{</span>
<span class="linenos" data-linenos="16 "></span>    <span class="k">private</span> <span class="nv">$potencia</span><span class="p">;</span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">getPotencia</span><span class="p">()</span> <span class="o">:</span> <span class="nx">int </span><span class="p">{</span>
<span class="linenos" data-linenos="19 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">potencia</span><span class="p">;</span>
<span class="linenos" data-linenos="20 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span>    <span class="c1">// No podemos implementar mostrarResumen()</span>
<span class="linenos" data-linenos="23 "></span><span class="p">}</span>
</code></pre></div>
<h2 id="39-interfaces">3.9 Interfaces<a class="headerlink" href="#39-interfaces" title="Permanent link">&para;</a></h2>
<p>Permite definir un contrato con las firmas de los métodos a cumplir. Así pues, sólo contiene declaraciones de funciones y todas deben ser públicas.</p>
<p>Se declaran con la palabra clave <code>interface</code> y luego las clases que cumplan el contrato lo realizan mediante la palabra clave <code>implements</code>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">interface</span> <span class="nx">Nombreable</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span><span class="c1">// declaración de funciones</span>
<span class="linenos" data-linenos="4 "></span><span class="p">}</span>
<span class="linenos" data-linenos="5 "></span><span class="k">class</span> <span class="nc">NombreClase</span> <span class="k">implements</span> <span class="nx">NombreInterfaz</span> <span class="p">{</span>
<span class="linenos" data-linenos="6 "></span><span class="c1">// código de la clase</span>
</code></pre></div>
<p>Se permite la herencia de interfaces. Además, una clase puede implementar varios interfaces (en este caso, sí soporta la herecia múltiple, pero sólo de interfaces).</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">interface</span> <span class="nx">Mostrable </span><span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarResumen</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="p">}</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="k">interface</span> <span class="nx">MostrableTodo extends Mostrable </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">mostrarTodo</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="p">}</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="k">interface</span> <span class="nx">Facturable </span><span class="p">{</span>
<span class="linenos" data-linenos="11 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">generarFactura</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span><span class="p">}</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span><span class="k">class</span> <span class="nc">Producto implements MostrableTodo</span><span class="p">,</span> <span class="nx">Facturable </span><span class="p">{</span>
<span class="linenos" data-linenos="15 "></span>    <span class="c1">// Implementaciones de los métodos</span>
<span class="linenos" data-linenos="16 "></span>    <span class="c1">// Obligatoriamente deberá implementar public function mostrarResumen, mostrarTodo y generarFactura</span>
<span class="linenos" data-linenos="17 "></span><span class="p">}</span>
</code></pre></div>
<h2 id="310-traits">3.10 Traits<a class="headerlink" href="#310-traits" title="Permanent link">&para;</a></h2>
<p>Los traits son un mecanismo de reutilización de código en un lenguaje de herencia simple como PHP. </p>
<p>Un <strong>trait</strong> es similar a una clase, pero solo <strong>sirve para agrupar funcionalidades</strong> que puede utilizar la clase que la use. No es posible instanciar un Trait en sí mismo.</p>
<p>Una clase puede usar más de un trait. Se indica en su cuerpo mediante <code>use Trait1, Trait2, Trait3;</code>.</p>
<p>Ejemplo:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span>   <span class="k">trait</span> <span class="nx">Logger</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>        <span class="k">public</span> <span class="nx">string</span> <span class="nv">$logLevel</span> <span class="o">=</span> <span class="s2">&quot;INFO&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span>        <span class="k">public</span> <span class="k">function</span> <span class="nf">log</span><span class="p">(</span><span class="nv">$message</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>            <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">logLevel</span> <span class="o">.</span><span class="s2">&quot; Logging: &quot;</span> <span class="o">.</span> <span class="nv">$message</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>        <span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span>    <span class="k">class</span> <span class="nc">User</span> <span class="p">{</span>
<span class="linenos" data-linenos="11 "></span>        <span class="k">use</span> <span class="nx">Logger</span><span class="p">;</span> <span class="c1">// Se incorpora el trait</span>
<span class="linenos" data-linenos="12 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span>    <span class="k">class</span> <span class="nc">Product</span> <span class="p">{</span>
<span class="linenos" data-linenos="15 "></span>        <span class="k">use</span> <span class="nx">Logger</span><span class="p">;</span> <span class="c1">// Se incorpora el mismo trait</span>
<span class="linenos" data-linenos="16 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span>    <span class="nv">$user</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">();</span>
<span class="linenos" data-linenos="19 "></span>    <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">(</span><span class="s2">&quot;User created&quot;</span><span class="p">);</span> <span class="c1">// El método del trait ahora está disponible en la clase</span>
<span class="linenos" data-linenos="20 "></span>
<span class="linenos" data-linenos="21 "></span>    <span class="nv">$product</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Product</span><span class="p">();</span>
<span class="linenos" data-linenos="22 "></span>    <span class="nv">$product</span><span class="o">-&gt;</span><span class="na">logLevel</span> <span class="o">=</span> <span class="s2">&quot;ALERT&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="23 "></span>    <span class="nv">$product</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">(</span><span class="s2">&quot;Product updated&quot;</span><span class="p">);</span> <span class="c1">// Y también en esta clase</span>
</code></pre></div>
<p>En la clase puedes usar las propiedades del trait como si fueran propias: leer, modificar y acceder de forma similar a como lo hace con la herencia:</p>
<ul>
<li>public: accesible desde cualquier sitio.</li>
<li>protected: accesible desde dentro de la clase que usa el trait.</li>
<li>private: sólo accesible desde dentro del trait.</li>
</ul>
<p><strong>El uso de trait está aconsejado para compartir métodos más que propiedades</strong>. </p>
<div class="admonition info">
<p class="admonition-title">Comparación con las interfaces</p>
<p>El trait inyecta métodos ya implementados y propiedades en la clase que lo use. A diferencia de la interfaz, que obliga a definir los métodos en la clase que la implemente.</p>
</div>
<h2 id="311-metodos-encadenados">3.11 Métodos encadenados<a class="headerlink" href="#311-metodos-encadenados" title="Permanent link">&para;</a></h2>
<p>Sigue el planteamiento de la programación funcional, y también se conoce como <em>method chaining</em>. Plantea que sobre un objeto se realizan varias llamadas.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="nv">$p1 </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Libro</span><span class="p">();</span>
<span class="linenos" data-linenos=" 3 "></span><span class="nv">$p1</span><span class="o">-&gt;</span><span class="na">setNombre</span><span class="p">(</span><span class="s2">&quot;Harry Potter&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 4 "></span><span class="nv">$p1</span><span class="o">-&gt;</span><span class="na">setAutor</span><span class="p">(</span><span class="s2">&quot;JK Rowling&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">echo</span> <span class="nv">$p1</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="c1">// Method chaining</span>
<span class="linenos" data-linenos=" 8 "></span><span class="nv">$p2 </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Libro</span><span class="p">();</span>
<span class="linenos" data-linenos=" 9 "></span><span class="nv">$p2</span><span class="o">-&gt;</span><span class="na">setNombre</span><span class="p">(</span><span class="s2">&quot;Patria&quot;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">setAutor</span><span class="p">(</span><span class="s2">&quot;Aramburu&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="10 "></span><span class="k">echo</span> <span class="nv">$p2</span><span class="p">;</span>
</code></pre></div>
<p>Para facilitarlo, vamos a modificar todos sus métodos mutadores (que modifican datos, <em>setters</em>, ...) para que devuelvan una referencia a <code>$this</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Libro </span><span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">private</span> <span class="nx">string </span><span class="nv">$nombre</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="k">private</span> <span class="nx">string </span><span class="nv">$autor</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">getNombre</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nombre</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">setNombre</span><span class="p">(</span><span class="nx">string </span><span class="nv">$nombre</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Libro </span><span class="p">{</span> 
<span class="linenos" data-linenos="10 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nombre </span><span class="o">=</span> <span class="nv">$nombre</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">getAutor</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string </span><span class="p">{</span>
<span class="linenos" data-linenos="15 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">autor</span><span class="p">;</span>
<span class="linenos" data-linenos="16 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="17 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">setAutor</span><span class="p">(</span><span class="nx">string </span><span class="nv">$autor</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Libro </span><span class="p">{</span>
<span class="linenos" data-linenos="18 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">autor </span><span class="o">=</span> <span class="nv">$autor</span><span class="p">;</span>
<span class="linenos" data-linenos="19 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="p">;</span>
<span class="linenos" data-linenos="20 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__toString</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string </span><span class="p">{</span>
<span class="linenos" data-linenos="23 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nombre</span><span class="o">.</span><span class="s2">&quot; de &quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">autor</span><span class="p">;</span>
<span class="linenos" data-linenos="24 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="25 "></span><span class="p">}</span>
</code></pre></div>
<h2 id="312-metodos-magicos">3.12 Métodos mágicos<a class="headerlink" href="#312-metodos-magicos" title="Permanent link">&para;</a></h2>
<p>Todas las clases PHP ofrecen un conjunto de métodos, también conocidos como <em>magic methods</em> que se pueden sobreescribir para sustituir su comportamiento. Algunos de ellos ya los hemos utilizado.</p>
<p>Ante cualquier duda, es conveniente consultar la <a href="https://www.php.net/manual/es/language.oop5.magic.php">documentación oficial</a>.</p>
<p>Los más destacables son:</p>
<ul>
<li><code>__construct()</code> → Se llama automáticamente la crear una instancia de la clase con <code>new</code>.</li>
<li><code>__destruct()</code> → Se invoca al perder la referencia. Se utiliza para cerrar una conexión a la BD, cerrar un fichero, ...</li>
<li><code>__toString()</code> → Representación del objeto como cadena. Es decir, cuando hacemos <code>echo $objeto</code> se ejecuta automáticamente este método.</li>
<li><code>__get(propiedad)</code>, <code>__set(propiedad, valor)</code> → Se ejecuta su código al acceder/modificar propiedades inaccesibles (protegidas o privadas) o inexistentes. Es más legible/mantenible codificar los <em>getter/setter</em>.</li>
<li><code>__isset(propiedad)</code>, <code>__unset(propiedad)</code> → Se invocan cuando se ejecuta <code>isset</code> o <code>unset</code> sobre propiedades inaccesibles o inexistentes.</li>
<li><code>__call()</code>, <code>__callStatic()</code> → Se ejecutan al llamar a un método inaccesible en el contexto de objeto o estático respectivamente.</li>
<li><code>__sleep()</code>, <code>__wakeup()</code> → Se ejecutan antes de serializar un objeto (<em>serialize</em>) o se reconstruye (<em>unserialize</em>), y se utilizan para definir qué propiedades se serializan.</li>
</ul>
<h2 id="313-espacio-de-nombres">3.13 Espacio de nombres<a class="headerlink" href="#313-espacio-de-nombres" title="Permanent link">&para;</a></h2>
<p>Desde PHP 5.3 y también conocidos como <em>namespaces</em>, permiten organizar las <em>clases/interfaces, funciones y/o constantes</em> de forma similar a los paquetes en <em>Java</em>. Están basados en el concepto similar a la organización de archivos en directorios que hacen los sistemas operativos: Sólo puede haber un archivo con el mismo nombre en un directorio y el acceso es ordenado estableciendo la ruta, evitando así conflictos de nombres.</p>
<h3 id="justificacion">Justificación<a class="headerlink" href="#justificacion" title="Permanent link">&para;</a></h3>
<p>Hoy en día con la cantidad de librerías de terceros que se importan en los proyectos, no es nada raro que en nuestro código necesitemos utilizar 2 clases que se llaman igual. Para ilustrar este concepto, supón que tenemos el siguiente código:  </p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="c1">// index.php</span>
<span class="linenos" data-linenos="3 "></span><span class="k">include_once</span> <span class="s2">&quot;app/modelo/compras/Producto.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span><span class="k">include_once</span> <span class="s2">&quot;app/modelo/ventas/Producto.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="5 "></span>
<span class="linenos" data-linenos="6 "></span><span class="c1">// No funciona, hay solapamiento de recursos</span>
<span class="linenos" data-linenos="7 "></span><span class="nv">$producto</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Producto</span><span class="p">(</span><span class="s2">&quot;Teclado Logitech MX Keys&quot;</span><span class="p">,</span> <span class="mf">56.99</span><span class="p">);</span>
<span class="linenos" data-linenos="8 "></span><span class="nv">$producto</span><span class="o">-&gt;</span><span class="na">compra</span><span class="p">();</span>
</code></pre></div>
<p>Como habrás comprobado, el intérprete de PHP no sabe qué clase <code>Producto</code> utilizar y no funciona. </p>
<p>¿Cómo se resuelve esta ambigüedad? Lo has adivinado, usando <em>espacios de nombres</em>. </p>
<h3 id="declaracion">Declaración<a class="headerlink" href="#declaracion" title="Permanent link">&para;</a></h3>
<p>Se declaran en la primera línea mediante la palabra clave <code>namespace</code> seguida del nombre del espacio de nombres asignado (cada subnivel se separa con la barra invertida <code>\</code>):</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">app/modelo/compras/Producto.php</label><label for="__tabbed_2_2">app/modelo/ventas/Producto.php</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="c1">// Declaración de su namespace al principio del archivo, antes de cualquier salida.</span>
<span class="hll"><span class="linenos" data-linenos=" 3 "></span><span class="k">namespace</span> <span class="nx">App\Modelo\Compras</span><span class="p">;</span>
</span><span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="c1">// Definición de constante y función fuera de la clase para</span>
<span class="linenos" data-linenos=" 6 "></span><span class="c1">// usos didácticos de los namespaces</span>
<span class="linenos" data-linenos=" 7 "></span><span class="k">const</span> <span class="no">IVA</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span><span class="k">function</span> <span class="nf">precioConIva</span><span class="p">(</span><span class="nx">Producto</span> <span class="nv">$producto</span><span class="p">)</span> <span class="o">:</span> <span class="nx">float</span> <span class="p">{</span>
<span class="linenos" data-linenos="10 "></span>    <span class="k">return</span> <span class="nv">$producto</span><span class="o">-&gt;</span><span class="na">getPrecio</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nx">IVA</span><span class="p">);</span>
<span class="linenos" data-linenos="11 "></span><span class="p">}</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="k">class</span> <span class="nc">Producto</span>
<span class="linenos" data-linenos="14 "></span><span class="p">{</span>
<span class="linenos" data-linenos="15 "></span>    <span class="k">private</span> <span class="nx">string</span> <span class="nv">$nombre</span><span class="p">;</span>
<span class="linenos" data-linenos="16 "></span>    <span class="k">private</span> <span class="nx">float</span> <span class="nv">$precio</span><span class="p">;</span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$nombre</span><span class="p">,</span> <span class="nx">float</span> <span class="nv">$precio</span><span class="p">)</span>
<span class="linenos" data-linenos="19 "></span>    <span class="p">{</span>
<span class="linenos" data-linenos="20 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nombre</span> <span class="o">=</span> <span class="nv">$nombre</span><span class="p">;</span>
<span class="linenos" data-linenos="21 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">precio</span> <span class="o">=</span> <span class="nv">$precio</span><span class="p">;</span>
<span class="linenos" data-linenos="22 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="23 "></span>
<span class="linenos" data-linenos="24 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">getPrecio</span><span class="p">()</span><span class="o">:</span> <span class="nx">float</span>
<span class="linenos" data-linenos="25 "></span>    <span class="p">{</span>
<span class="linenos" data-linenos="26 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">precio</span><span class="p">;</span>
<span class="linenos" data-linenos="27 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="28 "></span>
<span class="linenos" data-linenos="29 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">compra</span><span class="p">()</span> <span class="o">:</span> <span class="nx">void</span> <span class="p">{</span>
<span class="linenos" data-linenos="30 "></span>        <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;Compra del producto </span><span class="si">$this-&gt;nombre</span><span class="s2">&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="31 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="32 "></span><span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="c1">// Declaración de su namespace al principio del archivo, antes de cualquier salida.</span>
<span class="hll"><span class="linenos" data-linenos=" 3 "></span><span class="k">namespace</span> <span class="nx">App\Modelo\Ventas</span><span class="p">;</span>
</span><span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="c1">// Definición de constante y función fuera de la clase para</span>
<span class="linenos" data-linenos=" 6 "></span><span class="c1">// usos didácticos de los namespaces</span>
<span class="linenos" data-linenos=" 7 "></span><span class="k">const</span> <span class="no">IVA</span> <span class="o">=</span> <span class="mf">0.21</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span><span class="k">function</span> <span class="nf">precioConIva</span><span class="p">(</span><span class="nx">Producto</span> <span class="nv">$producto</span><span class="p">)</span> <span class="o">:</span> <span class="nx">float</span> <span class="p">{</span>
<span class="linenos" data-linenos="10 "></span>    <span class="k">return</span> <span class="nv">$producto</span><span class="o">-&gt;</span><span class="na">getPrecio</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nx">IVA</span><span class="p">);</span>
<span class="linenos" data-linenos="11 "></span><span class="p">}</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="k">class</span> <span class="nc">Producto</span>
<span class="linenos" data-linenos="14 "></span><span class="p">{</span>
<span class="linenos" data-linenos="15 "></span>    <span class="k">private</span> <span class="nx">string</span> <span class="nv">$nombre</span><span class="p">;</span>
<span class="linenos" data-linenos="16 "></span>    <span class="k">private</span> <span class="nx">float</span> <span class="nv">$precio</span><span class="p">;</span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$nombre</span><span class="p">,</span> <span class="nx">float</span> <span class="nv">$precio</span><span class="p">)</span>
<span class="linenos" data-linenos="19 "></span>    <span class="p">{</span>
<span class="linenos" data-linenos="20 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">nombre</span> <span class="o">=</span> <span class="nv">$nombre</span><span class="p">;</span>
<span class="linenos" data-linenos="21 "></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">precio</span> <span class="o">=</span> <span class="nv">$precio</span><span class="p">;</span>
<span class="linenos" data-linenos="22 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="23 "></span>
<span class="linenos" data-linenos="24 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">getPrecio</span><span class="p">()</span><span class="o">:</span> <span class="nx">float</span>
<span class="linenos" data-linenos="25 "></span>    <span class="p">{</span>
<span class="linenos" data-linenos="26 "></span>        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">precio</span><span class="p">;</span>
<span class="linenos" data-linenos="27 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="28 "></span><span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Recomendación</p>
<p>Un sólo namespace por archivo y crear una estructura de carpetas respectando los niveles/subniveles (igual que se hace en <em>Java</em>).</p>
</div>
<h3 id="acceso">Acceso<a class="headerlink" href="#acceso" title="Permanent link">&para;</a></h3>
<p>Para referenciar a un recurso que contiene un namespace, primero hemos de tenerlo disponible haciendo uso de <code>include</code> o <code>require</code>, igual que hasta ahora. </p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="c1">// index.php en la raíz del proyecto, al nivel de app</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">include_once</span> <span class="s2">&quot;app/modelo/compras/Producto.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">include_once</span> <span class="s2">&quot;app/modelo/ventas/Producto.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="hll"><span class="linenos" data-linenos=" 6 "></span><span class="nv">$producto1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\App\Modelo\Compras\Producto</span><span class="p">(</span><span class="s2">&quot;Teclado Logitech MX Keys&quot;</span><span class="p">,</span> <span class="mf">84.99</span><span class="p">);</span>
</span><span class="linenos" data-linenos=" 7 "></span><span class="nv">$producto1</span><span class="o">-&gt;</span><span class="na">compra</span><span class="p">();</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="hll"><span class="linenos" data-linenos=" 9 "></span><span class="nv">$producto2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\App\Modelo\Ventas\Producto</span><span class="p">(</span><span class="s2">&quot;Ratón Logitech MX Master 3S&quot;</span><span class="p">,</span> <span class="mf">56.99</span><span class="p">);</span>
</span><span class="linenos" data-linenos="10 "></span><span class="nv">$producto2</span><span class="o">-&gt;</span><span class="na">venta</span><span class="p">();</span>
</code></pre></div>
<p>Existen tres tipos de acceso:</p>
<ul>
<li>totalmente cualificado: <code>\rutaAbsoluta\recurso</code></li>
<li>cualificado: <code>rutaRelativa\recurso</code> → no hace falta poner el <em>namespace</em> completo</li>
<li>sin cualificar: <code>recurso</code></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="c1">// listado.php en app/modelo/</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">namespace</span> <span class="nx">App\Modelo</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">include_once</span> <span class="s2">&quot;ventas/Producto.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="nv">$producto2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Ventas\Producto</span><span class="p">(</span><span class="s2">&quot;Ratón Logitech MX Master 3S&quot;</span><span class="p">,</span> <span class="mf">56.99</span><span class="p">);</span>
<span class="linenos" data-linenos=" 8 "></span><span class="nv">$producto2</span><span class="o">-&gt;</span><span class="na">venta</span><span class="p">();</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="c1">// Totalmente cualificado --&gt; absoluta desde raíz</span>
<span class="linenos" data-linenos="11 "></span><span class="c1">// Cualificado --&gt; relativo al namespace actual</span>
<span class="linenos" data-linenos="12 "></span><span class="c1">// No cualificado --&gt; relativo al namespace actual</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span><span class="k">echo</span> <span class="nx">\App\Modelo\Ventas\IVA</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span><span class="k">echo</span> <span class="nx">Ventas\IVA</span><span class="p">;</span>
<span class="linenos" data-linenos="16 "></span><span class="k">echo</span> <span class="nx">IVA</span><span class="p">;</span> <span class="c1">// No funciona: no existe IVA en el namespace actual</span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span><span class="k">echo</span> <span class="nx">\App\Modelo\Ventas\precioConIva</span><span class="p">(</span><span class="nv">$producto2</span><span class="p">);</span>
<span class="linenos" data-linenos="19 "></span><span class="k">echo</span> <span class="nx">Ventas\precioConIva</span><span class="p">(</span><span class="nv">$producto2</span><span class="p">);</span>
<span class="linenos" data-linenos="20 "></span><span class="k">echo</span> <span class="nx">precioConIva</span><span class="p">(</span><span class="nv">$producto2</span><span class="p">);</span> <span class="c1">// No funciona: no existe precioConIva en el namespace actual</span>
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span><span class="nv">$p1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\App\Modelo\Ventas\Producto</span><span class="p">(</span><span class="s2">&quot;Producto...&quot;</span><span class="p">,</span> <span class="mf">11.99</span><span class="p">);</span>
<span class="linenos" data-linenos="23 "></span><span class="nv">$p2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Ventas\Producto</span><span class="p">(</span><span class="s2">&quot;Producto...&quot;</span><span class="p">,</span> <span class="mf">11.99</span><span class="p">);</span>
<span class="linenos" data-linenos="24 "></span><span class="nv">$p3</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Producto</span><span class="p">(</span><span class="s2">&quot;Producto...&quot;</span><span class="p">,</span> <span class="mf">11.99</span><span class="p">);</span> <span class="c1">// No funciona: no existe Producto en el namespace actual</span>
</code></pre></div>
<p>Para evitar la referencia cualificada podemos declarar el uso mediante <code>use</code> (similar a hacer <code>import</code> en <em>Java</em>). Se hace en la cabecera, tras el <code>namespace</code>:</p>
<p>Los tipos posibles son:</p>
<ul>
<li><code>use const nombreCualificadoConstante</code></li>
<li><code>use function nombreCualificadoFuncion</code></li>
<li><code>use nombreCualificadoClase</code></li>
<li><code>use nombreCualificadoClase as NuevoNombre</code> // para renombrar elementos</li>
</ul>
<p>Por ejemplo, si queremos utilizar la clase <code>\App\Modelo\Ventas\Producto</code> desde un recurso que se encuentra en la raíz, por ejemplo en <code>index.php</code>, haríamos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">include_once</span> <span class="s2">&quot;app/modelo/compras/Producto.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">include_once</span> <span class="s2">&quot;app/modelo/ventas/Producto.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">use</span> <span class="k">const</span> <span class="no">\App\Modelo\Ventas\IVA</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="k">use</span> <span class="k">function</span> <span class="nf">\App\Modelo\Ventas\precioConIva</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="k">use</span> <span class="nx">\App\Modelo\Ventas\Producto</span> <span class="k">as</span> <span class="nx">ProductoVenta</span><span class="p">;</span> <span class="c1">// Hay que renombrar la clase Producto</span>
<span class="linenos" data-linenos=" 8 "></span><span class="k">use</span> <span class="nx">\App\Modelo\Compras\Producto</span> <span class="k">as</span> <span class="nx">ProductoCompra</span><span class="p">;</span> <span class="c1">// Hay que renombrar la clase Producto</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="nv">$producto1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ProductoCompra</span><span class="p">(</span><span class="s2">&quot;Teclado Logitech MX Keys&quot;</span><span class="p">,</span> <span class="mf">84.99</span><span class="p">);</span>
<span class="linenos" data-linenos="11 "></span><span class="nv">$producto1</span><span class="o">-&gt;</span><span class="na">compra</span><span class="p">();</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="nv">$producto2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ProductoVenta</span><span class="p">(</span><span class="s2">&quot;Ratón Logitech MX Master 3S&quot;</span><span class="p">,</span> <span class="mf">56.99</span><span class="p">);</span>
<span class="linenos" data-linenos="14 "></span><span class="nv">$producto2</span><span class="o">-&gt;</span><span class="na">venta</span><span class="p">();</span>
<span class="linenos" data-linenos="15 "></span>
<span class="linenos" data-linenos="16 "></span><span class="k">echo</span> <span class="nx">IVA</span><span class="p">;</span>
<span class="linenos" data-linenos="17 "></span><span class="k">echo</span> <span class="nx">precioConIva</span><span class="p">(</span><span class="nv">$producto2</span><span class="p">);</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">To <code>use</code> or not to <code>use</code></p>
<p>En resumen, <code>use</code> permite acceder sin cualificar a recursos que están en otro <em>namespace</em>. Si estamos en el mismo espacio de nombre, no necesitamos <code>use</code>.</p>
</div>
<h3 id="organizacion">Organización<a class="headerlink" href="#organizacion" title="Permanent link">&para;</a></h3>
<p>Todo proyecto, conforme crece, necesita organizar su código fuente. Se plantea una organización en la que los archivos que interactuan con el navegador se colocan en la raíz, y las clases que definamos van dentro de un namespace (y dentro de su propia carpeta <code>src</code> o <code>app</code>).</p>
<div class="admonition tip">
<p class="admonition-title">Organización, includes y usos</p>
<ul>
<li>Colocaremos cada recurso en un fichero aparte.</li>
<li>En la primera línea indicaremos su <em>namespace</em> (si no está en el raíz).</li>
<li>Si utilizamos otros recursos, haremos un <code>include_once</code> de esos recursos (clases, interfaces, etc...). Cada recurso debe incluir todos los otros recursos que referencie: la clase de la que hereda, interfaces que implementa, clases utilizadas/recibidas como parámetros, etc...</li>
<li>Si los recursos están en un espacio de nombres diferente al que estamos, emplearemos <code>use</code> con la ruta completa para luego utilizar referencias sin cualificar.</li>
</ul>
</div>
<h3 id="autoload">Autoload<a class="headerlink" href="#autoload" title="Permanent link">&para;</a></h3>
<p>¿No es tedioso tener que hacer el <code>include</code> de los archivos con los recursos? El <em>autoload</em> viene al rescate.</p>
<p>Así pues, permite cargar las clases (no las constantes ni las funciones) que se van a utilizar y evitar tener que hacer el <code>include_once</code> de cada una de ellas. Para ello, se utiliza la función <code>spl_autoload_register</code></p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="nb">spl_autoload_register</span><span class="p">(</span> <span class="k">function</span><span class="p">(</span> <span class="nv">$nombreClase </span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">include_once</span> <span class="nv">$nombreClase</span><span class="o">.</span><span class="s1">&#39;.php&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span><span class="p">}</span> <span class="p">);</span>
<span class="linenos" data-linenos="5 "></span><span class="cp">?&gt;</span>
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">¿Por qué se llaman <em>autoload</em>?</p>
<p>Porque antes se realizaba mediante el método mágico <code>__autoload()</code>, el cual está <em>obsoleto</em> desde PHP 7.2</p>
</div>
<figure style="float: right;">
    <img src="imagenes/03/03autoload2025.png" width="260">
    <figcaption>Organización con autoload</figcaption>
</figure>

<p>Y ¿cómo organizamos ahora nuestro código aprovechando el <em>autoload</em>?</p>
<p>Para facilitar la búsqueda de los recursos a incluir, es recomendable colocar todas las clases dentro de una misma carpeta y seguir el estándar <em>PSR-4</em>. Nosotros la vamos a colocar dentro de <code>app</code> (más adelante, cuando estudiemos <em>Laravel</em> veremos el motivo de esta decisión). Otras carpetas que podemos crear son <code>test</code> para colocar las pruebas <em>PhpUnit</em> que luego realizaremos, o la carpeta <code>vendor</code> donde se almacenarán las librerías del proyecto (esta carpeta es un estándard dentro de PHP, ya que <em>Composer</em> la crea automáticamente).</p>
<p>Como hemos colocado todos nuestros recursos dentro de <code>app</code>, ahora nuestro <code>autoload.php</code> (el cual colocamos en la carpeta raíz) sólo va a buscar dentro de esa carpeta:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="nb">spl_autoload_register</span><span class="p">(</span> <span class="k">function</span><span class="p">(</span> <span class="nv">$nombreClase </span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">include_once</span> <span class="s2">&quot;app/&quot;</span><span class="o">.</span><span class="nv">$nombreClase</span><span class="o">.</span><span class="s1">&#39;.php&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span><span class="p">}</span> <span class="p">);</span>
<span class="linenos" data-linenos="5 "></span><span class="cp">?&gt;</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Autoload y rutas erróneas</p>
<p>En <em>sistemas UNIX</em> (Docker incluido) al hacer el <em>include</em> de la clase que recibe como parámetro, las barras de los namespace (<code>\</code>) son diferentes a las de las rutas (<code>/</code>). Por ello, es mejor que utilicemos el fichero autoload:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="nb">spl_autoload_register</span><span class="p">(</span> <span class="k">function</span><span class="p">(</span> <span class="nv">$nombreClase </span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>    <span class="nv">$ruta</span> <span class="o">=</span> <span class="s2">&quot;app</span><span class="se">\\</span><span class="s2">&quot;</span><span class="o">.</span><span class="nv">$nombreClase</span><span class="o">.</span><span class="s1">&#39;.php&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span>    <span class="nv">$ruta</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="nv">$ruta</span><span class="p">);</span> <span class="c1">// Sustituimos las barras</span>
<span class="linenos" data-linenos="5 "></span>    <span class="k">include_once</span> <span class="nv">$ruta</span><span class="p">;</span>
<span class="linenos" data-linenos="6 "></span><span class="p">}</span> <span class="p">);</span>
<span class="linenos" data-linenos="7 "></span><span class="cp">?&gt;</span>
</code></pre></div>
</div>
<details>
<summary>PHP-FIG y el Estándar PSR-4</summary>
<p><a href="https://www.php-fig.org/">PHP-FIG</a> es un grupo de programadores que tiene como objetivos promover el ecosistema de PHP y definir estándares basados en la investigación, experimentación y sobre todo en la experiencia del mundo real, para <em>facilitar la colaboración entre programadores y proyectos</em>.</p>
<p>La Recomendación 4 de Estándares PHP <a href="https://www.php-fig.org/psr/psr-4/">PSR-4</a> es un estándar establecido por <em>PHP-FIG</em>  que proporciona una convención común para la carga automática de clases PHP según espacios de nombres. La <em>PSR-4</em> simplifica la organización de clases y archivos, facilitando la gestión de grandes bases de código y la colaboración en proyectos.</p>
</details>
<h2 id="314-gestion-de-errores">3.14 Gestión de Errores<a class="headerlink" href="#314-gestion-de-errores" title="Permanent link">&para;</a></h2>
<p>PHP clasifica los errores que ocurren en diferentes niveles. Cada nivel se identifica con una constante. Por ejemplo:</p>
<ul>
<li><code>E_ERROR</code>: errores fatales, no recuperables. Se interrumpe el script.</li>
<li><code>E_WARNING</code>: advertencias en tiempo de ejecución. El script no se interrumpe.</li>
<li><code>E_NOTICE</code>: avisos en tiempo de ejecución.  </li>
</ul>
<p>Podéis comprobar el listado completo de constantes de <a href="https://www.php.net/manual/es/errorfunc.constants.php">https://www.php.net/manual/es/errorfunc.constants.php</a></p>
<p>Para la configuración de los errores podemos hacerlo de dos formas:</p>
<ul>
<li>A nivel de <code>php.ini</code>:<ul>
<li><code>error_reporting</code>: indica los niveles de errores a notificar<ul>
<li><code>error_reporting = E_ALL &amp; ~E_NOTICE</code> -&gt; Todos los errores menos los avisos en tiempo de ejecución.</li>
</ul>
</li>
<li><code>display_errors</code>: indica si mostrar o no los errores por pantalla. <strong>En entornos de producción hay que ponerlo a <code>off</code>.</strong></li>
</ul>
</li>
<li>Mediante código con las siguientes funciones:<ul>
<li><code>error_reporting(codigo)</code> -&gt; Controla qué errores notificar</li>
<li><code>set_error_handler(nombreManejador)</code> -&gt; Indica qué función se invocará cada vez que se encuentre un error. El manejador recibe como parámetros el nivel del error y el mensaje</li>
</ul>
</li>
</ul>
<p>A continuación tenemos un ejemplo mediante código:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Funciones para la gestión de errores</label><label for="__tabbed_3_2">Consola</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="nb">error_reporting</span><span class="p">(</span><span class="k">E_ALL</span> <span class="o">&amp;</span> <span class="o">~</span><span class="nx">E_NOTICE </span><span class="o">&amp;</span> <span class="o">~</span><span class="k">E_WARNING</span><span class="p">);</span>
<span class="linenos" data-linenos=" 3 "></span><span class="nv">$resultado </span><span class="o">=</span> <span class="nv">$dividendo </span><span class="o">/</span> <span class="nv">$divisor</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="nb">error_reporting</span><span class="p">(</span><span class="k">E_ALL</span> <span class="o">&amp;</span> <span class="o">~</span><span class="nx">E_NOTICE</span><span class="p">);</span>
<span class="linenos" data-linenos=" 6 "></span><span class="nb">set_error_handler</span><span class="p">(</span><span class="s2">&quot;miManejadorErrores&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 7 "></span><span class="nv">$resultado </span><span class="o">=</span> <span class="nv">$dividendo </span><span class="o">/</span> <span class="nv">$divisor</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="nb">restore_error_handler</span><span class="p">();</span> <span class="c1">// vuelve al anterior</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="k">function</span> <span class="nf">miManejadorErrores</span><span class="p">(</span><span class="nv">$nivel</span><span class="p">,</span> <span class="nv">$mensaje</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="11 "></span>    <span class="k">switch</span><span class="p">(</span><span class="nv">$nivel</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="12 "></span>        <span class="k">case</span> <span class="k">E_WARNING</span><span class="o">:</span>
<span class="linenos" data-linenos="13 "></span>            <span class="k">echo</span> <span class="s2">&quot;&lt;strong&gt;Warning&lt;/strong&gt;: </span><span class="si">$mensaje</span><span class="s2">.&lt;br/&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="14 "></span>            <span class="k">break</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span>        <span class="k">default</span><span class="o">:</span>
<span class="linenos" data-linenos="16 "></span>            <span class="k">echo</span> <span class="s2">&quot;Error de tipo no especificado: </span><span class="si">$mensaje</span><span class="s2">.&lt;br/&gt;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="17 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="18 "></span><span class="p">}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>Error de tipo no especificado: Undefined variable: dividendo.
<span class="linenos" data-linenos="2 "></span>Error de tipo no especificado: Undefined variable: divisor.
<span class="linenos" data-linenos="3 "></span>Error de tipo Warning: Division by zero.
</code></pre></div>
</div>
</div>
</div>
<h2 id="315-excepciones">3.15 Excepciones<a class="headerlink" href="#315-excepciones" title="Permanent link">&para;</a></h2>
<p>La gestión de excepciones forma parte desde PHP 5. Su funcionamiento es similar a <em>Java</em>, haciendo uso de un bloque <code>try / catch / finally</code>.
Si detectamos una situación anómala y queremos lanzar una excepción, deberemos realizar <code>throw new Exception</code> (adjuntando el mensaje que lo ha provocado).</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">try</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>    <span class="k">if</span> <span class="p">(</span><span class="nv">$divisor </span><span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="4 "></span>        <span class="k">throw</span> <span class="k">new</span> <span class="nx">Exception</span><span class="p">(</span><span class="s2">&quot;División por cero.&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="5 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="6 "></span>    <span class="nv">$resultado </span><span class="o">=</span> <span class="nv">$dividendo </span><span class="o">/</span> <span class="nv">$divisor</span><span class="p">;</span>
<span class="linenos" data-linenos="7 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception </span><span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="8 "></span>    <span class="k">echo</span> <span class="s2">&quot;Se ha producido el siguiente error: &quot;</span><span class="o">.</span><span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span>
<span class="linenos" data-linenos="9 "></span><span class="p">}</span>
</code></pre></div>
<p>La clase <code>Exception</code> es la clase padre de todas las excepciones. Su constructor recibe <code>mensaje[codigoError][excepcionPrevia]</code>.</p>
<p>A partir de un objeto <code>Exception</code>, podemos acceder a los métodos <code>getMessage()</code>y <code>getCode()</code> para obtener el mensaje y el código de error de la excepción capturada.</p>
<p>El propio lenguaje ofrece un conjunto de excepciones ya definidas, las cuales podemos capturar (y lanzar desde PHP 7). Se recomienda su consulta en la <a href="https://www.php.net/manual/es/class.exception.php">documentación oficial</a>.</p>
<h3 id="crear-excepciones">Crear excepciones<a class="headerlink" href="#crear-excepciones" title="Permanent link">&para;</a></h3>
<p>Para crear una excepción, la forma más corta es crear una clase que únicamente herede de <code>Exception</code>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">class</span> <span class="nc">HolaExcepcion extends Exception </span><span class="p">{}</span>
</code></pre></div>
<p>Si queremos, y es recomendable dependiendo de los requisitos, podemos sobrecargar los métodos mágicos, por ejemplo, sobrecargando el constructor y llamando al constructor del padre, o rescribir el método <code>__toString</code> para cambiar su mensaje:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">MiExcepcion extends Exception </span><span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$msj</span><span class="p">,</span> <span class="nv">$codigo </span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">Exception </span><span class="nv">$previa </span><span class="o">=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span>        <span class="c1">// código propio</span>
<span class="linenos" data-linenos=" 5 "></span>        <span class="k">parent</span><span class="o">::</span><span class="na">__construct</span><span class="p">(</span><span class="nv">$msj</span><span class="p">,</span> <span class="nv">$codigo</span><span class="p">,</span> <span class="nv">$previa</span><span class="p">);</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__toString</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span>        <span class="k">return</span> <span class="no">__CLASS__</span> <span class="o">.</span> <span class="s2">&quot;: [</span><span class="si">{</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">code</span><span class="si">}</span><span class="s2">]: </span><span class="si">{</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">message</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="10 "></span>    <span class="k">public</span> <span class="k">function</span> <span class="nf">miFuncion</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos" data-linenos="11 "></span>        <span class="k">echo</span> <span class="s2">&quot;Una función personalizada para este tipo de excepción</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="13 "></span><span class="p">}</span>
</code></pre></div>
<p>Si definimos una excepción de aplicación dentro de un <em>namespace</em>, cuando referenciemos a <code>Exception</code>, deberemos referenciarla mediante su nombre totalmente cualificado (<code>\Exception</code>), o utilizando <code>use</code>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">Mediante nombre totalmente cualificado</label><label for="__tabbed_4_2">Mediante <code>use</code></label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">namespace</span> <span class="nx">\Dwes\Ejemplos</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span><span class="k">class</span> <span class="nc">AppExcepcion extends \Exception </span><span class="p">{}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">namespace</span> <span class="nx">\Dwes\Ejemplos</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span><span class="k">use</span> <span class="nx">Exception</span><span class="p">;</span> <span class="c1">// Sin &quot;use&quot; buscaría Exception en el namespace actual</span>
<span class="linenos" data-linenos="5 "></span>
<span class="linenos" data-linenos="6 "></span><span class="k">class</span> <span class="nc">AppExcepcion extends Exception </span><span class="p">{}</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="excepciones-multiples">Excepciones múltiples<a class="headerlink" href="#excepciones-multiples" title="Permanent link">&para;</a></h3>
<p>Se pueden usar excepciones múltiples para comprobar diferentes condiciones. A la hora de capturarlas, se hace de más específica a más general.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="nv">$email </span><span class="o">=</span> <span class="s2">&quot;ejemplo@ejemplo.com&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">try</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="c1">// Comprueba si el email es válido</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="k">if</span><span class="p">(</span><span class="nb">filter_var</span><span class="p">(</span><span class="nv">$email</span><span class="p">,</span> <span class="nx">FILTER_VALIDATE_EMAIL</span><span class="p">)</span> <span class="o">===</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>        <span class="k">throw</span> <span class="k">new</span> <span class="nx">MiExcepcion</span><span class="p">(</span><span class="nv">$email</span><span class="p">);</span>
<span class="linenos" data-linenos=" 7 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="c1">// Comprueba la palabra ejemplo en la dirección email</span>
<span class="linenos" data-linenos=" 9 "></span>    <span class="k">if</span><span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$email</span><span class="p">,</span> <span class="s2">&quot;ejemplo&quot;</span><span class="p">)</span> <span class="o">!==</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="10 "></span>        <span class="k">throw</span> <span class="k">new</span> <span class="nx">Exception</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">$email es un email de ejemplo</span><span class="s2"> no válido&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="11 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="12 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">MiExcepcion </span><span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="13 "></span>    <span class="k">echo</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">miFuncion</span><span class="p">();</span>
<span class="linenos" data-linenos="14 "></span><span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">Exception </span><span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="15 "></span>    <span class="k">echo</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span>
<span class="linenos" data-linenos="16 "></span><span class="p">}</span>
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Autoevaluación</p>
<p>¿Qué pasaría al ejectuar el siguiente código?
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">MainException extends Exception </span><span class="p">{}</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">class</span> <span class="nc">SubException extends MainException </span><span class="p">{}</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">try</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="k">throw</span> <span class="k">new</span> <span class="nx">SubException</span><span class="p">(</span><span class="s2">&quot;Lanzada SubException&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 7 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">MainException </span><span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span>    <span class="k">echo</span> <span class="s2">&quot;Capturada MainException &quot;</span> <span class="o">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span>
<span class="linenos" data-linenos=" 9 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">SubException </span><span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="10 "></span>    <span class="k">echo</span> <span class="s2">&quot;Capturada SubException &quot;</span> <span class="o">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span>
<span class="linenos" data-linenos="11 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception </span><span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="12 "></span>    <span class="k">echo</span> <span class="s2">&quot;Capturada Exception &quot;</span> <span class="o">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span>
<span class="linenos" data-linenos="13 "></span><span class="p">}</span>
</code></pre></div></p>
</div>
<p>Si en el mismo <code>catch</code> queremos capturar varias excepciones, hemos de utilizar el operador <code>|</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">class</span> <span class="nc">MainException extends Exception </span><span class="p">{}</span>
<span class="linenos" data-linenos="3 "></span><span class="k">class</span> <span class="nc">SubException extends MainException </span><span class="p">{}</span>
<span class="linenos" data-linenos="4 "></span>
<span class="linenos" data-linenos="5 "></span><span class="k">try</span> <span class="p">{</span>
<span class="linenos" data-linenos="6 "></span>    <span class="k">throw</span> <span class="k">new</span> <span class="nx">SubException</span><span class="p">(</span><span class="s2">&quot;Lanzada SubException&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="7 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">MainException </span><span class="o">|</span> <span class="nx">SubException </span><span class="nv">$e </span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="8 "></span>    <span class="k">echo</span> <span class="s2">&quot;Capturada Exception &quot;</span> <span class="o">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span>
<span class="linenos" data-linenos="9 "></span><span class="p">}</span>
</code></pre></div>
<p>Desde PHP 7, existe el tipo <code>Throwable</code>, el cual es un interfaz que implementan tanto los errores como las excepciones, y nos permite capturar los dos tipos a la vez:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">try</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>    <span class="c1">// tu codigo</span>
<span class="linenos" data-linenos="4 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Throwable </span><span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="5 "></span>    <span class="k">echo</span> <span class="s1">&#39;Forma de capturar errores y excepciones a la vez&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="6 "></span><span class="p">}</span>
</code></pre></div>
<p>Si sólo queremos capturar los errores fatales, podemos hacer uso de la clase <code>Error</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">try</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>    <span class="c1">// Genera una notificación que no se captura</span>
<span class="linenos" data-linenos="4 "></span>    <span class="k">echo</span> <span class="nv">$variableNoAsignada</span><span class="p">;</span>
<span class="linenos" data-linenos="5 "></span>    <span class="c1">// Error fatal que se captura</span>
<span class="linenos" data-linenos="6 "></span>    <span class="nx">funcionQueNoExiste</span><span class="p">();</span>
<span class="linenos" data-linenos="7 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Error </span><span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="8 "></span>    <span class="k">echo</span> <span class="s2">&quot;Error capturado: &quot;</span> <span class="o">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span>
<span class="linenos" data-linenos="9 "></span><span class="p">}</span>
</code></pre></div>
<h3 id="relanzar-excepciones">Relanzar excepciones<a class="headerlink" href="#relanzar-excepciones" title="Permanent link">&para;</a></h3>
<p>En las aplicaciones reales, es muy común capturar una excepción de sistema y lanzar una de aplicación que hemos definido nostros.
También podemos lanzar las excepciones sin necesidad de estar dentro de un <code>try/catch</code>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">class</span> <span class="nc">AppException extends Exception </span><span class="p">{}</span>
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span><span class="k">try</span> <span class="p">{</span>
<span class="linenos" data-linenos="5 "></span>    <span class="c1">// Código de negocio que falla</span>
<span class="linenos" data-linenos="6 "></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception </span><span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="7 "></span>    <span class="k">throw</span> <span class="k">new</span> <span class="nx">AppException</span><span class="p">(</span><span class="s2">&quot;AppException: &quot;</span><span class="o">.</span><span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">(),</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getCode</span><span class="p">(),</span> <span class="nv">$e</span><span class="p">);</span>
<span class="linenos" data-linenos="8 "></span><span class="p">}</span>
</code></pre></div>
<h2 id="316-spl">3.16 SPL<a class="headerlink" href="#316-spl" title="Permanent link">&para;</a></h2>
<p><em>Standard PHP Library</em> es el conjunto de funciones y utilidades que ofrece PHP, como:</p>
<ul>
<li>Estructuras de datos<ul>
<li>Pila, cola, cola de prioridad, lista doblemente enlazada, etc... </li>
</ul>
</li>
<li>Conjunto de iteradores diseñados para recorrer estructuras agregadas<ul>
<li>arrays, resultados de bases de datos, árboles XML, listados de directorios, etc.</li>
</ul>
</li>
</ul>
<p>Podéis consultar la documentación en <a href="https://www.php.net/manual/es/book.spl.php">https://www.php.net/manual/es/book.spl.php</a> o ver algunos ejemplos en <a href="https://diego.com.es/tutorial-de-la-libreria-spl-de-php">https://diego.com.es/tutorial-de-la-libreria-spl-de-php</a></p>
<p>También define un conjunto de excepciones que podemos utilizar para que las lancen nuestras aplicaciones:</p>
<ul>
<li><code>LogicException</code> (<code>extends Exception</code>)<ul>
<li><code>BadFunctionCallException</code></li>
<li><code>BadMethodCallException</code></li>
<li><code>DomainException</code></li>
<li><code>InvalidArgumentException</code></li>
<li><code>LengthException</code></li>
<li><code>OutOfRangeException</code></li>
</ul>
</li>
<li><code>RuntimeException</code> (<code>extends Exception</code>)<ul>
<li><code>OutOfBoundsException</code></li>
<li><code>OverflowException</code></li>
<li><code>RangeException</code></li>
<li><code>UnderflowException</code></li>
<li><code>UnexpectedValueException</code></li>
</ul>
</li>
</ul>
<p>También podéis consultar la documentación de estas excepciones en <a href="https://www.php.net/manual/es/spl.exceptions.php">https://www.php.net/manual/es/spl.exceptions.php</a>.</p>
<h2 id="317-referencias">3.17 Referencias<a class="headerlink" href="#317-referencias" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://www.php.net/manual/es/index.php">Manual de PHP</a></li>
<li><a href="https://desarrolloweb.com/manuales/manual-php.html#manual68">Manual de OO en PHP - www.desarrolloweb.com</a></li>
</ul>
<h2 id="318-actividades">3.18 Actividades<a class="headerlink" href="#318-actividades" title="Permanent link">&para;</a></h2>
<ol start="300">
<li>Investiga la diferencia entre un paradigma orientado a objetos basado en clases (<em>PHP</em>) respecto a uno basado en prototipos (<em>JavaScript</em>).</li>
</ol>
<h3 id="objetos">Objetos<a class="headerlink" href="#objetos" title="Permanent link">&para;</a></h3>
<ol start="301">
<li><code>301Empleado.php</code>: Crea una clase <code>Empleado</code> con su nombre, apellidos y sueldo.
Encapsula las propiedades mediante <em>getters/setters</em> y añade métodos para:<ul>
<li>Obtener su nombre completo → <code>getNombreCompleto(): string</code></li>
<li>Que devuelva un booleano indicando si debe o no pagar impuestos (se pagan cuando el sueldo es superior a 3333€) → <code>debePagarImpuestos(): bool</code></li>
</ul>
</li>
<li><code>302EmpleadoTelefonos.php</code>: Copia la clase del ejercicio anterior y modifícala.
Añade una propiedad privada que almacene un array de números de teléfonos.
Añade los siguientes métodos:<ul>
<li><code>public function anyadirTelefono(int $telefono) : void</code> → Añade un teléfono al array</li>
<li><code>public function listarTelefonos(): string</code> → Muestra los teléfonos separados por comas</li>
<li><code>public function vaciarTelefonos(): void</code> → Elimina todos los teléfonos</li>
</ul>
</li>
<li>
<p><code>303EmpleadoConstructor.php</code>: Copia la clase del ejercicio anterior y modifícala.
Elimina los <em>setters</em> de <code>nombre</code> y <code>apellidos</code>, de manera que dichos datos se asignan mediante el constructor (utiliza la sintaxis de PHP7).
Si el constructor recibe un tercer parámetro, será el sueldo del <code>Empleado</code>. Si no, se le asignará 1000€ como sueldo inicial.</p>
<p><code>303EmpleadoConstructor8.php</code>: Modifica la clase y utiliza la sintaxis de PHP 8 de promoción de las propiedades del constructor.</p>
</li>
<li>
<p><code>304EmpleadoConstante.php</code>: Copia la clase del ejercicio anterior y modifícala.
Añade una constante <code>SUELDO_TOPE</code> con el valor del sueldo que debe pagar impuestos, y modifica el código para utilizar la constante.</p>
</li>
<li><code>305EmpleadoSueldo.php</code>: Copia la clase del ejercicio anterior y modifícala.
Cambia la constante por una variable estática <code>sueldoTope</code>, de manera que mediante <em>getter/setter</em> puedas modificar su valor.</li>
<li>
<p><code>306EmpleadoStatic.php</code>: Copia la clase del ejercicio anterior y modifícala.
Completa el siguiente método con una cadena HTML que muestre los datos de un empleado dentro de un párrafo y todos los teléfonos mediante una lista ordenada (para ello, deberás crear un <em>getter</em> para los teléfonos):</p>
<ul>
<li><code>public static function toHtml(Empleado $emp): string</code></li>
</ul>
<p><figure style="float: right;">
    <img src="imagenes/03/03p307.png">
    <figcaption>Ejercicio 307</figcaption>
</figure></p>
</li>
<li>
<p><code>307Persona.php</code>: Copia la clase del ejercicio anterior en <code>307Empleado.php</code> y modifícala.<br />
Crea una clase <code>Persona</code> que sea padre de <code>Empleado</code>, de manera que <code>Persona</code> contenga el nombre y los apellidos, y en <code>Empleado</code> quede el salario y los teléfonos.</p>
</li>
<li>
<p><code>308PersonaH.php</code>: Copia las clases del ejercicio anterior y modifícalas. Crea en <code>Persona</code> el método estático <code>toHtml(Persona $p)</code>, y modifica en <code>Empleado</code> el mismo método <code>toHtml(Persona $p)</code>, pero cambia la firma para que reciba una <code>Persona</code> como parámetro.<br />
    Para acceder a las propiedades del empleado con la persona que recibimos como parámetro, comprobaremos su tipo:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">class</span> <span class="nc">Empleado</span> <span class="k">extends</span> <span class="nx">Persona</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="c1">/// resto del código</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span>    <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">toHtml</span><span class="p">(</span><span class="nx">Persona</span> <span class="nv">$p</span><span class="p">)</span><span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span>        <span class="k">if</span> <span class="p">(</span><span class="nv">$p</span> <span class="nx">instanceof</span> <span class="nx">Empleado</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span>            <span class="c1">// Aqui ya podemos acceder a las propiedades y métodos de Empleado</span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="p">}</span>
<span class="linenos" data-linenos="10 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="11 "></span><span class="p">}</span>
</code></pre></div>
</li>
<li>
<p><code>309PersonaE.php</code>: Copia las clases del ejercicio anterior y modifícalas.<br />
Añade en <code>Persona</code> un atributo <code>edad</code><br />
A la hora de saber si un empleado debe pagar impuestos, lo hará siempre y cuando tenga más de 21 años y dependa del valor de su sueldo.
Modifica todo el código necesario para mostrar y/o editar la edad cuando sea necesario.</p>
</li>
<li>
<p><code>310PersonaS.php</code>: Copia las clases del ejercicio anterior y modifícalas.<br />
Añade nuevos métodos que hagan una representación de todas las propiedades de las clases <code>Persona</code> y <code>Empleado</code>, de forma similar a los realizados en HTML, pero sin que sean estáticos, de  manera que obtenga los datos mediante <code>$this</code>.</p>
<ul>
<li><code>function public __toString(): string</code></li>
</ul>
</li>
</ol>
<div class="admonition tip">
<p class="admonition-title"><em>Magic methods</em></p>
<p>El método <code>__toString()</code> es un método mágico que se invoca automáticamente cuando queremos obtener la representación en cadena de un objeto.</p>
</div>
<ol start="311">
<li>
<p><code>311PersonaA.php</code>: Copia las clases del ejercicio anterior y modifícalas.<br />
Transforma <code>Persona</code> a una clase abstracta donde su método estático <code>toHtml(Persona $p)</code> tenga que ser redefinido en todos sus hijos.</p>
</li>
<li>
<p><code>312Trabajador.php</code>: Copia las clases del ejercicio anterior y modifícalas.</p>
<ul>
<li>Cambia la estructura de clases conforme al gráfico respetando todos los métodos que ya están hechos.</li>
<li><code>Trabajador</code> es una clase abstracta que ahora almacena los <code>telefonos</code> y donde <code>calcularSueldo</code> es un método abstracto de manera que:<ul>
<li>El sueldo de un <code>Empleado</code> se calcula a partir de las horas trabajadas y lo que cobra por hora.</li>
<li>Para los <code>Gerente</code>s, su sueldo se incrementa porcentualmente en base a su edad: <code>salario + salario*edad/100</code></li>
</ul>
</li>
</ul>
<p><figure>
    <img src="imagenes/03/03p312.png">
    <figcaption>Ejercicio 312</figcaption>
</figure></p>
</li>
<li>
<p><code>313Empresa.php</code>: Utilizando las clases de los ejercicios anteriores:</p>
<ul>
<li>Crea una clase <code>Empresa</code> que además del nombre y la dirección, contenga una propiedad con un array de <code>Trabajador</code>es, ya sean <code>Empleado</code>s o <code>Gerente</code>s. </li>
<li>Añade <em>getters/setters</em> para el nombre y dirección.</li>
<li>Añade métodos para añadir y listar los trabajadores.<ul>
<li><code>public function anyadirTrabajador(Trabajador $t)</code></li>
<li><code>public function listarTrabajadoresHtml() : string</code> -&gt; utiliza <code>Trabajador::toHtml(Persona $p)</code></li>
</ul>
</li>
<li>Añade un método para obtener el coste total en nóminas.<ul>
<li><code>public function getCosteNominas(): float</code> -&gt; recorre los trabajadores e invoca al método <code>calcularSueldo()</code>.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>314EmpresaI.php</code>: Copia las clases del ejercicio anterior y modifícalas.</p>
<ul>
<li>Crea un interfaz JSerializable, de manera que ofrezca los métodos:<ul>
<li><code>toJSON(): string</code> → utiliza la función <a href="https://www.php.net/manual/es/function.json-encode.php"><code>json_encode(mixed)</code></a>. La idea es obtener la representación JSON de las propiedades de un objeto. Tendrás que recorrerarlas y colocarlas en un mapa que se le pasará a la función. Por ejemplo:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">public</span> <span class="k">function</span> <span class="nf">toJSON</span><span class="p">()</span><span class="o">:</span> <span class="nx">string</span> <span class="p">{</span>
<span class="linenos" data-linenos="3 "></span>    <span class="nv">$mapa</span> <span class="o">=</span> <span class="p">[];</span>
<span class="linenos" data-linenos="4 "></span>    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$this</span> <span class="k">as</span> <span class="nv">$clave</span> <span class="o">=&gt;</span> <span class="nv">$valor</span><span class="p">)</span> <span class="p">{</span>
<span class="linenos" data-linenos="5 "></span>        <span class="nv">$mapa</span><span class="p">[</span><span class="nv">$clave</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$valor</span><span class="p">;</span>
<span class="linenos" data-linenos="6 "></span>    <span class="p">}</span>
<span class="linenos" data-linenos="7 "></span>    <span class="k">return</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$mapa</span><span class="p">);</span>
<span class="linenos" data-linenos="8 "></span><span class="p">}</span>
<span class="linenos" data-linenos="9 "></span><span class="cp">?&gt;</span>
</code></pre></div></li>
<li><code>toSerialize(): string</code> → utiliza la función <a href="https://www.php.net/manual/es/function.serialize.php"><code>serialize(mixed)</code></a></li>
</ul>
</li>
<li>Modifica todas las clases que no son abstractas para que implementen el interfaz creado.</li>
</ul>
</li>
</ol>
<h3 id="proyecto-videoclub-10-teoria-hasta-interfaces">Proyecto Videoclub 1.0 (teoría hasta interfaces)<a class="headerlink" href="#proyecto-videoclub-10-teoria-hasta-interfaces" title="Permanent link">&para;</a></h3>
<p>En los siguientes ejercicios vamos a simular un pequeño proyecto de un Videoclub, el cual vamos a realizar mediante un desarrollo incremental y siguiendo la práctica de programación en parejas (<em>pair programming</em>).</p>
<p>Antes de nada, crea un repositorio privado en GitHub y sube el proyecto actual de <em>Videoclub</em>. Una vez creado, invita a tu compañero al repositorio como colaborador.</p>
<ul>
<li>Inicializa en local tu repostorio de git, mediante <code>git init</code></li>
<li>Añade y sube los cambios a tu repositorio, mediante <code>git add .</code> y luego <code>git commit -m 'Inicializando proyecto'.</code></li>
<li>Conecta tu repositorio con GitHub y sube los cambios (mira la instrucciones de GitHub: comandos <code>git remote</code> y <code>git push</code>).</li>
<li>Tu compañero deberá descargar el proyecto con sus credenciales.</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Proyecto no real</p>
<p>El siguiente proyecto está pensado desde un punto de vista formativo. Algunas de las decisiones que se toman no se deben usar (como hacer <code>echo</code> dentro de las clases) o probar el código comparando el resultado en el navegador.</p>
</div>
<p>Cada clase debe ir en un archivo php separado. Para facilitar su implementación, se muestra la estructura UML del modelo y un fragmento de código para probar las clases:</p>
<figure style="float: right;">
    <img src="imagenes/03/03p320.png" width="150">
    <figcaption>Creamos el Soporte</figcaption>
</figure>

<ol start="320">
<li>
<p>Crea una clase para almacenar soportes (<code>Soporte.php</code>). Esta clase será la clase padre de los diferentes soportes con los que trabaje nuestro videoclub (cintas de vídeo, videojuegos, etc...):</p>
<ul>
<li>Crea el constructor que inicialice sus propiedades. Fíjate que la clase no tiene métodos <em>setters</em>.</li>
<li>Definir una constante mediante un propiedad privada denominada <code>IVA</code> con un valor del 21%. Nota: Ojo, <strong>las constantes admiten tipos de datos a partir de PHP 8.3</strong>.</li>
<li>Crear un archivo (<code>inicio.php</code>) para usar las clases y copia el siguiente fragmento:</li>
</ul>
</li>
</ol>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">Código de prueba</label><label for="__tabbed_5_2">Navegador</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">include</span> <span class="s2">&quot;Soporte.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span><span class="nv">$soporte1 </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Soporte</span><span class="p">(</span><span class="s2">&quot;Tenet&quot;</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> 
<span class="linenos" data-linenos="5 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;strong&gt;&quot;</span> <span class="o">.</span> <span class="nv">$soporte1</span><span class="o">-&gt;</span><span class="na">titulo </span><span class="o">.</span> <span class="s2">&quot;&lt;/strong&gt;&quot;</span><span class="p">;</span> 
<span class="linenos" data-linenos="6 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;Precio: &quot;</span> <span class="o">.</span> <span class="nv">$soporte1</span><span class="o">-&gt;</span><span class="na">getPrecio</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot; euros&quot;</span><span class="p">;</span> 
<span class="linenos" data-linenos="7 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;Precio IVA incluido: &quot;</span> <span class="o">.</span> <span class="nv">$soporte1</span><span class="o">-&gt;</span><span class="na">getPrecioConIVA</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot; euros&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="8 "></span><span class="nv">$soporte1</span><span class="o">-&gt;</span><span class="na">muestraResumen</span><span class="p">();</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><pre>
<strong>Tenet</strong>
Precio: 3 euros
Precio IVA incluido: 3.63 euros
<em>Tenet</em>
3 € (IVA no incluido)
</pre></p>
</div>
</div>
</div>
<figure style="float: right;">
    <img src="imagenes/03/03p321.png" width="150">
    <figcaption>Añadimos Cinta de Video</figcaption>
</figure>

<ol>
<li>
<p>Crea la clase <code>CintaVideo</code> la cual hereda de <code>Soporte</code>. Añade el atributo <code>duracion</code> y sobreescribe tanto el contructor como el método <code>muestraResumen</code> (desde <code>CintaVideo</code> deberás llamar al método <code>muestraResumen</code> del padre).</p>
<p>Añade a <code>inicio.php</code> el código para probar la clase:</p>
</li>
</ol>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">Código de prueba</label><label for="__tabbed_6_2">Navegador</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">include</span> <span class="s2">&quot;CintaVideo.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span><span class="nv">$miCinta </span><span class="o">=</span> <span class="k">new</span> <span class="nx">CintaVideo</span><span class="p">(</span><span class="s2">&quot;Los cazafantasmas&quot;</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">107</span><span class="p">);</span> 
<span class="linenos" data-linenos="5 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;strong&gt;&quot;</span> <span class="o">.</span> <span class="nv">$miCinta</span><span class="o">-&gt;</span><span class="na">titulo </span><span class="o">.</span> <span class="s2">&quot;&lt;/strong&gt;&quot;</span><span class="p">;</span> 
<span class="linenos" data-linenos="6 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;Precio: &quot;</span> <span class="o">.</span> <span class="nv">$miCinta</span><span class="o">-&gt;</span><span class="na">getPrecio</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot; euros&quot;</span><span class="p">;</span> 
<span class="linenos" data-linenos="7 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;Precio IVA incluido: &quot;</span> <span class="o">.</span> <span class="nv">$miCinta</span><span class="o">-&gt;</span><span class="na">getPrecioConIva</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot; euros&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="8 "></span><span class="nv">$miCinta</span><span class="o">-&gt;</span><span class="na">muestraResumen</span><span class="p">();</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><pre>
<strong>Los cazafantasmas</strong>
Precio: 3.5 euros
Precio IVA incluido: 4.06 euros
Película en VHS:
<em>Los cazafantasmas</em>
3.5 € (IVA no incluido)
Duración: 107 minutos
</pre></p>
</div>
</div>
</div>
<figure style="float: right;">
    <img src="imagenes/03/03p322.png" width="250">
    <figcaption>Añadimos Dvd</figcaption>
</figure>

<ol start="322">
<li>
<p>Crea la clase <code>Dvd</code> la cual hereda de <code>Soporte</code>. Añade los atributos <code>idiomas</code> y <code>formatoPantalla</code>. A continuación sobreescribe tanto el contructor como el método <code>muestraResumen</code>.</p>
<p>Añade a <code>inicio.php</code> el código para probar la clase:</p>
</li>
</ol>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">Código de prueba</label><label for="__tabbed_7_2">Navegador</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">include</span> <span class="s2">&quot;Dvd.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span><span class="nv">$miDvd </span><span class="o">=</span> <span class="k">new</span> <span class="nx">Dvd</span><span class="p">(</span><span class="s2">&quot;Origen&quot;</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;es,en,fr&quot;</span><span class="p">,</span> <span class="s2">&quot;16:9&quot;</span><span class="p">);</span> 
<span class="linenos" data-linenos="5 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;strong&gt;&quot;</span> <span class="o">.</span> <span class="nv">$miDvd</span><span class="o">-&gt;</span><span class="na">titulo </span><span class="o">.</span> <span class="s2">&quot;&lt;/strong&gt;&quot;</span><span class="p">;</span> 
<span class="linenos" data-linenos="6 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;Precio: &quot;</span> <span class="o">.</span> <span class="nv">$miDvd</span><span class="o">-&gt;</span><span class="na">getPrecio</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot; euros&quot;</span><span class="p">;</span> 
<span class="linenos" data-linenos="7 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;Precio IVA incluido: &quot;</span> <span class="o">.</span> <span class="nv">$miDvd</span><span class="o">-&gt;</span><span class="na">getPrecioConIva</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot; euros&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="8 "></span><span class="nv">$miDvd</span><span class="o">-&gt;</span><span class="na">muestraResumen</span><span class="p">();</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><pre>
<strong>Origen</strong>
Precio: 15 euros
Precio IVA incluido: 17.4 euros
Película en DVD:
<em>Origen</em>
15 € (IVA no incluido)
Idiomas:es,en,fr
Formato Pantalla:16:9
</pre></p>
</div>
</div>
</div>
<figure style="float: right;">
    <img src="imagenes/03/03p323.png" width="350">
    <figcaption>Añadimos Juego</figcaption>
</figure>

<ol start="323">
<li>
<p>Crea la clase <code>Juego</code> la cual hereda de <code>Soporte</code>. Añade los atributos <code>consola</code>, <code>minNumJugadores</code> y <code>maxNumJugadores</code>. A continuación añade el método <code>muestraJugadoresPosibles</code>, el cual debe mostrar <em>Para un jugador</em>, <em>Para X jugadores</em> o <em>De X a Y jugadores</em> dependiendo de los valores de las atributos creados. Finalmente, sobreescribe tanto el contructor como el método <code>muestraResumen</code>.</p>
<p>Añade a <code>inicio.php</code> el código para probar la clase:</p>
</li>
</ol>
<div class="tabbed-set tabbed-alternate" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">Código de prueba</label><label for="__tabbed_8_2">Navegador</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos="2 "></span><span class="k">include</span> <span class="s2">&quot;Juego.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span><span class="nv">$miJuego</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Juego</span><span class="p">(</span><span class="s2">&quot;The Last of Us Part II&quot;</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mf">49.99</span><span class="p">,</span> <span class="s2">&quot;PS4&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> 
<span class="linenos" data-linenos="5 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;strong&gt;&quot;</span> <span class="o">.</span> <span class="nv">$miJuego</span><span class="o">-&gt;</span><span class="na">titulo</span> <span class="o">.</span> <span class="s2">&quot;&lt;/strong&gt;&quot;</span><span class="p">;</span> 
<span class="linenos" data-linenos="6 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;Precio: &quot;</span> <span class="o">.</span> <span class="nv">$miJuego</span><span class="o">-&gt;</span><span class="na">getPrecio</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot; euros&quot;</span><span class="p">;</span> 
<span class="linenos" data-linenos="7 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;Precio IVA incluido: &quot;</span> <span class="o">.</span> <span class="nv">$miJuego</span><span class="o">-&gt;</span><span class="na">getPrecioConIva</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot; euros&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="8 "></span><span class="nv">$miJuego</span><span class="o">-&gt;</span><span class="na">muestraResumen</span><span class="p">();</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><pre>
<strong>The Last of Us Part II</strong>
Precio: 49.99 euros
Precio IVA incluido: 57.9884 euros
Juego para: PS4
<em>The Last of Us Part II</em>
49.99 € (IVA no incluido)
Para un jugador
</pre></p>
</div>
</div>
</div>
<p>Llegados a este punto, nuestro modelo es similar al siguiente diagrama:</p>
<figure>
    <img src="imagenes/03/03videoclub1.png" width="600">
    <figcaption>Modelo inicial de Videoclub</figcaption>
</figure>

<figure style="float: right;">
    <img src="imagenes/03/03p324.png" width="275">
    <figcaption>Añadimos Cliente</figcaption>
</figure>

<ol start="324">
<li>
<p>Crear la clase <code>Cliente</code>. El constructor recibirá el <code>nombre</code>, <code>numero</code> y <code>maxAlquilerConcurrente</code>, este último pudiendo ser opcional y tomando como valor por defecto 3. Tras ello, añade <em>getter/setter</em> únicamente a <code>numero</code>, y un <em>getter</em> a <code>numSoportesAlquilados</code> (este campo va a almacenar un contador del total de alquileres que ha realizado). El array de soportes alquilados contedrá instancias de clases que hereden de <code>Soporte</code>. Finalmente, añade el método <code>muestraResumen</code> que muestre el nombre y la cantidad de alquileres (tamaño del array <code>soportesAlquilados</code>).</p>
</li>
<li>
<p>Dentro de <code>Cliente</code>, añade las siguiente operaciones:</p>
<ul>
<li><code>tieneAlquilado(Soporte $s): bool</code> → Recorre el array de soportes y comprueba si está el soporte</li>
<li><code>alquilar(Soporte $s): bool</code> → Debe comprobar si ya tiene el soporte alquilado y si no ha superado el cupo de alquileres. Al alquilar, incrementará el <code>numSoportesAlquilados</code> y almacenará el soporte en el array. Para cada caso debe mostrar un mensaje informando de lo ocurrido.</li>
</ul>
</li>
<li>
<p>Seguimos con <code>Cliente</code> para añadir las operaciones:</p>
<ul>
<li><code>devolver(int $numSoporte): bool</code> → Debe comprobar que el soporte estaba alquilado  y actualizar la cantidad de soportes alquilados. Para cada caso debe mostrar un mensaje informando de lo ocurrido</li>
<li><code>listaAlquileres(): void</code> → Informa de cuantos alquileres tiene el cliente y los muestra.</li>
</ul>
</li>
</ol>
<p>Crea el archivo <code>inicio2.php</code> con el siguiente código fuente para probar la clase:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">Código de prueba</label><label for="__tabbed_9_2">Navegador</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">include_once</span> <span class="s2">&quot;CintaVideo.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">include_once</span> <span class="s2">&quot;Dvd.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">include_once</span> <span class="s2">&quot;Juego.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">include_once</span> <span class="s2">&quot;Cliente.php&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="c1">//instanciamos un par de objetos cliente</span>
<span class="linenos" data-linenos=" 8 "></span><span class="nv">$cliente1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cliente</span><span class="p">(</span><span class="s2">&quot;Bruce Wayne&quot;</span><span class="p">,</span> <span class="mi">23</span><span class="p">);</span>
<span class="linenos" data-linenos=" 9 "></span><span class="nv">$cliente2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cliente</span><span class="p">(</span><span class="s2">&quot;Clark Kent&quot;</span><span class="p">,</span> <span class="mi">33</span><span class="p">);</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="c1">//mostramos el número de cada cliente creado </span>
<span class="linenos" data-linenos="12 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;El identificador del cliente 1 es: &quot;</span> <span class="o">.</span> <span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">getNumero</span><span class="p">();</span>
<span class="linenos" data-linenos="13 "></span><span class="k">echo</span> <span class="s2">&quot;&lt;br&gt;El identificador del cliente 2 es: &quot;</span> <span class="o">.</span> <span class="nv">$cliente2</span><span class="o">-&gt;</span><span class="na">getNumero</span><span class="p">();</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="c1">//instancio algunos soportes </span>
<span class="linenos" data-linenos="16 "></span><span class="nv">$soporte1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CintaVideo</span><span class="p">(</span><span class="s2">&quot;Los cazafantasmas&quot;</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">107</span><span class="p">);</span>
<span class="linenos" data-linenos="17 "></span><span class="nv">$soporte2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Juego</span><span class="p">(</span><span class="s2">&quot;The Last of Us Part II&quot;</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mf">49.99</span><span class="p">,</span> <span class="s2">&quot;PS4&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>  
<span class="linenos" data-linenos="18 "></span><span class="nv">$soporte3</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dvd</span><span class="p">(</span><span class="s2">&quot;Origen&quot;</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;es,en,fr&quot;</span><span class="p">,</span> <span class="s2">&quot;16:9&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="19 "></span><span class="nv">$soporte4</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dvd</span><span class="p">(</span><span class="s2">&quot;El Imperio Contraataca&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;es,en&quot;</span><span class="p">,</span><span class="s2">&quot;16:9&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="20 "></span>
<span class="linenos" data-linenos="21 "></span><span class="c1">//alquilo algunos soportes</span>
<span class="linenos" data-linenos="22 "></span><span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">alquilar</span><span class="p">(</span><span class="nv">$soporte1</span><span class="p">);</span>
<span class="linenos" data-linenos="23 "></span><span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">alquilar</span><span class="p">(</span><span class="nv">$soporte2</span><span class="p">);</span>
<span class="linenos" data-linenos="24 "></span><span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">alquilar</span><span class="p">(</span><span class="nv">$soporte3</span><span class="p">);</span>
<span class="linenos" data-linenos="25 "></span>
<span class="linenos" data-linenos="26 "></span><span class="c1">//voy a intentar alquilar de nuevo un soporte que ya tiene alquilado</span>
<span class="linenos" data-linenos="27 "></span><span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">alquilar</span><span class="p">(</span><span class="nv">$soporte1</span><span class="p">);</span>
<span class="linenos" data-linenos="28 "></span><span class="c1">//el cliente tiene 3 soportes en alquiler como máximo</span>
<span class="linenos" data-linenos="29 "></span><span class="c1">//este soporte no lo va a poder alquilar</span>
<span class="linenos" data-linenos="30 "></span><span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">alquilar</span><span class="p">(</span><span class="nv">$soporte4</span><span class="p">);</span>
<span class="linenos" data-linenos="31 "></span><span class="c1">//este soporte no lo tiene alquilado</span>
<span class="linenos" data-linenos="32 "></span><span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">devolver</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="linenos" data-linenos="33 "></span><span class="c1">//devuelvo un soporte que sí que tiene alquilado</span>
<span class="linenos" data-linenos="34 "></span><span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">devolver</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos" data-linenos="35 "></span><span class="c1">//alquilo otro soporte</span>
<span class="linenos" data-linenos="36 "></span><span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">alquilar</span><span class="p">(</span><span class="nv">$soporte4</span><span class="p">);</span>
<span class="linenos" data-linenos="37 "></span><span class="c1">//listo los elementos alquilados</span>
<span class="linenos" data-linenos="38 "></span><span class="nv">$cliente1</span><span class="o">-&gt;</span><span class="na">listaAlquileres</span><span class="p">();</span>
<span class="linenos" data-linenos="39 "></span><span class="c1">//este cliente no tiene alquileres</span>
<span class="linenos" data-linenos="40 "></span><span class="nv">$cliente2</span><span class="o">-&gt;</span><span class="na">devolver</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><pre>
El identificador del cliente 1 es: 23
El identificador del cliente 2 es: 33
<strong>Alquilado soporte a</strong>: Bruce Wayne</p>
<p>Película en VHS:
<em>Los cazafantasmas</em>
3.5 € (IVA no incluido)
Duración: 107 minutos</p>
<p><strong>Alquilado soporte a</strong>: Bruce Wayne</p>
<p>Juego para: PS4
<em>The Last of Us Part II</em>
49.99 € (IVA no incluido)
Para un jugador</p>
<p><strong>Alquilado soporte a</strong>: Bruce Wayne</p>
<p>Película en DVD:
<em>Origen</em>
15 € (IVA no incluido)
Idiomas:es,en,fr
Formato Pantalla:16:9</p>
<p>El cliente ya tiene alquilado el soporte <strong>Los cazafantasmas</strong></p>
<p>Este cliente tiene 3 elementos alquilados. No puede alquilar más en este videoclub hasta que no devuelva algo</p>
<p>No se ha podido encontrar el soporte en los alquileres de este cliente</p>
<p>No se ha podido encontrar el soporte en los alquileres de este cliente</p>
<p>Este cliente tiene 3 elementos alquilados. No puede alquilar más en este videoclub hasta que no devuelva algo</p>
<p><strong>El cliente tiene 3 soportes alquilados</strong></p>
<p>Película en VHS:
<em>Los cazafantasmas</em>
3.5 € (IVA no incluido)
Duración: 107 minutos</p>
<p>Juego para: PS4
<em>The Last of Us Part II</em>
49.99 € (IVA no incluido)
Para un jugador</p>
<p>Película en DVD:
<em>Origen</em>
15 € (IVA no incluido)
Idiomas:es,en,fr
Formato Pantalla:16:9</p>
<p>Este cliente no tiene alquilado ningún elemento
</pre></p>
</div>
</div>
</div>
<ol start="327">
<li>Llegado a este punto, vamos a relacionar los clientes y los soportes mediante la clase <code>Videoclub</code>. Así pues crea la clase que representa el gráfico, teniendo en cuenta que:<ul>
<li><code>productos</code> es un array de <code>Soporte</code></li>
<li><code>socios</code> es una array de <code>Cliente</code></li>
<li>Los métodos públicos de incluir algún soporte, crearán la instancia de la clase correspondiente y llamarán al método privado de <code>incluirProducto</code>, el cual es el encargado de introducirlo dentro del array.</li>
</ul>
</li>
</ol>
<p>El modelo completo quedará de la siguiente manera:</p>
<figure>
    <img src="imagenes/03/03videoclub2.png" width="800">
    <figcaption>Modelo completo de Videoclub</figcaption>
</figure>

<p>Y para probar el proyecto, dentro <code>inicio3.php</code> colocaremos:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:2"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><input id="__tabbed_10_2" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">Código de prueba</label><label for="__tabbed_10_2">Navegador</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cp">&lt;?php</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">include_once</span> <span class="s2">&quot;Videoclub.php&quot;</span><span class="p">;</span> <span class="c1">// No incluimos nada más</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="nv">$vc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Videoclub</span><span class="p">(</span><span class="s2">&quot;Severo 8A&quot;</span><span class="p">);</span> 
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="c1">//voy a incluir unos cuantos soportes de prueba </span>
<span class="linenos" data-linenos=" 7 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">incluirJuego</span><span class="p">(</span><span class="s2">&quot;God of War&quot;</span><span class="p">,</span> <span class="mf">19.99</span><span class="p">,</span> <span class="s2">&quot;PS4&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> 
<span class="linenos" data-linenos=" 8 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">incluirJuego</span><span class="p">(</span><span class="s2">&quot;The Last of Us Part II&quot;</span><span class="p">,</span> <span class="mf">49.99</span><span class="p">,</span> <span class="s2">&quot;PS4&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="linenos" data-linenos=" 9 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">incluirDvd</span><span class="p">(</span><span class="s2">&quot;Torrente&quot;</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="s2">&quot;es&quot;</span><span class="p">,</span><span class="s2">&quot;16:9&quot;</span><span class="p">);</span> 
<span class="linenos" data-linenos="10 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">incluirDvd</span><span class="p">(</span><span class="s2">&quot;Origen&quot;</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="s2">&quot;es,en,fr&quot;</span><span class="p">,</span> <span class="s2">&quot;16:9&quot;</span><span class="p">);</span> 
<span class="linenos" data-linenos="11 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">incluirDvd</span><span class="p">(</span><span class="s2">&quot;El Imperio Contraataca&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;es,en&quot;</span><span class="p">,</span><span class="s2">&quot;16:9&quot;</span><span class="p">);</span> 
<span class="linenos" data-linenos="12 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">incluirCintaVideo</span><span class="p">(</span><span class="s2">&quot;Los cazafantasmas&quot;</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">107</span><span class="p">);</span> 
<span class="linenos" data-linenos="13 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">incluirCintaVideo</span><span class="p">(</span><span class="s2">&quot;El nombre de la Rosa&quot;</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">140</span><span class="p">);</span> 
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="c1">//listo los productos </span>
<span class="linenos" data-linenos="16 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">listarProductos</span><span class="p">();</span> 
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span><span class="c1">//voy a crear algunos socios </span>
<span class="linenos" data-linenos="19 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">incluirSocio</span><span class="p">(</span><span class="s2">&quot;Amancio Ortega&quot;</span><span class="p">);</span> 
<span class="linenos" data-linenos="20 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">incluirSocio</span><span class="p">(</span><span class="s2">&quot;Pablo Picasso&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> 
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">alquilarSocioProducto</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> 
<span class="linenos" data-linenos="23 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">alquilarSocioProducto</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> 
<span class="linenos" data-linenos="24 "></span><span class="c1">//alquilo otra vez el soporte 2 al socio 1. </span>
<span class="linenos" data-linenos="25 "></span><span class="c1">// no debe dejarme porque ya lo tiene alquilado </span>
<span class="linenos" data-linenos="26 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">alquilarSocioProducto</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> 
<span class="linenos" data-linenos="27 "></span><span class="c1">//alquilo el soporte 6 al socio 1. </span>
<span class="linenos" data-linenos="28 "></span><span class="c1">//no se puede porque el socio 1 tiene 2 alquileres como máximo </span>
<span class="linenos" data-linenos="29 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">alquilarSocioProducto</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span> 
<span class="linenos" data-linenos="30 "></span>
<span class="linenos" data-linenos="31 "></span><span class="c1">//listo los socios </span>
<span class="linenos" data-linenos="32 "></span><span class="nv">$vc</span><span class="o">-&gt;</span><span class="na">listarSocios</span><span class="p">();</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><pre>
Incluido soporte 0
Incluido soporte 1
Incluido soporte 2
Incluido soporte 3
Incluido soporte 4
Incluido soporte 5
Incluido soporte 6</p>
<p>Listado de los 7 productos disponibles:
1.- Juego para: PS4
<em>God of War</em>
19.99 € (IVA no incluido)
Para un jugador
2.- Juego para: PS4
<em>The Last of Us Part II</em>
49.99 € (IVA no incluido)
Para un jugador
3.- Película en DVD:
<em>Torrente</em>
4.5 € (IVA no incluido)
Idiomas:es
Formato Pantalla:16:9
4.- Película en DVD:
<em>Origen</em>
4.5 € (IVA no incluido)
Idiomas:es,en,fr
Formato Pantalla:16:9
5.- Película en DVD:
<em>El Imperio Contraataca</em>
3 € (IVA no incluido)
Idiomas:es,en
Formato Pantalla:16:9
6.- Película en VHS:
<em>Los cazafantasmas</em>
3.5 € (IVA no incluido)
Duración: 107 minutos
7.- Película en VHS:
<em>El nombre de la Rosa</em>
1.5 € (IVA no incluido)
Duración: 140 minutos</p>
<p>Incluido socio 0
Incluido socio 1</p>
<p><strong>Alquilado soporte a</strong>: Pablo Picasso</p>
<p>Película en DVD:
<em>Torrente</em>
4.5 € (IVA no incluido)
Idiomas:es
Formato Pantalla:16:9</p>
<p>** Alquilado soporte a**: Pablo Picasso</p>
<p>Película en DVD:
<em>Origen</em>
4.5 € (IVA no incluido)
Idiomas:es,en,fr
Formato Pantalla:16:9</p>
<p>El cliente ya tiene alquilado el soporte Torrente</p>
<p>Este cliente tiene 2 elementos alquilados. No puede alquilar más en este videoclub hasta que no devuelva algo</p>
<p>Listado de 2 socios del videoclub:
1.- <strong>Cliente 0</strong>: Amancio Ortega
Alquileres actuales: 0
2.- <strong>Cliente 1</strong>: Pablo Picasso
Alquileres actuales: 2
</pre></p>
</div>
</div>
</div>
<ol start="328">
<li>
<p>Transforma <code>Soporte</code> a una clase abstracta y comprueba que todo sigue funcionando. ¿Qué conseguimos al hacerla abstracta?</p>
</li>
<li>
<p>Crea un interfaz <code>Resumible</code>, de manera que las clases que lo implementen deben ofrecer el método <code>muestraResumen()</code>. Modifica la clase <code>Soporte</code> y haz que implemente el interfaz. ¿Hace falta que también lo implementen los hijos?</p>
</li>
</ol>
<h3 id="proyecto-videoclub-20-teoria-hasta-el-final">Proyecto Videoclub 2.0 (teoría hasta el final)<a class="headerlink" href="#proyecto-videoclub-20-teoria-hasta-el-final" title="Permanent link">&para;</a></h3>
<p>Antes de comenzar con la segunda parte del videoclub, crea una etiqueta mediante <code>git tag</code> con el nombre <code>v0.329</code> y sube los cambios a GitHub.</p>
<ol start="330">
<li>Modifica la operación de alquilar en <code>Videoclub</code>, para dar soporte al encadenamiento de métodos. 
Posteriormente, modifica el código de prueba para utilizar esta técnica, de tal forma que quede así:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">    $vc-&gt;alquilarSocioProducto(1,2)-&gt;alquilarSocioProducto(1,3)-&gt;alquilarSocioProducto(1,2)-&gt;alquilarSocioProducto(1,6);</span>
</code></pre></div>
<ol start="331">
<li>Haciendo uso de <em>namespaces</em>:<ul>
<li>Coloca todas las clases/interfaces en <code>Dwes\ProyectoVideoclub</code></li>
<li>Cada clase debe hacer <code>include_once</code> de los recursos que emplea</li>
<li>Coloca el/los archivos de prueba en el raíz (sin espacio de nombres)</li>
<li>Desde el archivo de pruebas, utiliza <code>use</code> para poder realizar accesos sin cualificar</li>
<li>Etiqueta los cambios como <code>v0.331</code>.</li>
</ul>
</li>
<li>Reorganiza las carpeta tal como hemos visto en los apuntes: <code>app</code>, <code>test</code> y <code>vendor</code>.<ul>
<li>Crea un fichero <code>autoload.php</code> para registrar la ruta donde encontrar las clases</li>
<li>Modifica todo el código necesario, incluyendo <code>autoload.php</code> donde sea necesario y borrando los <em>includes</em> previos.</li>
</ul>
</li>
<li>A continuación vamos a crear un conjunto de excepciones de aplicación. Estas excepciones son simples, no necesitan sobreescribir ningún método. Así pues, crea la excepción de aplicación <code>VideoclubException</code> en el <em>namespace</em> <code>Dwes\ProyectoVideoclub\Util</code>.
Posteriormente crea los siguientes hijos (deben heredar de <code>VideoclubException</code>), cada uno en su propio archivo:<ul>
<li><code>SoporteYaAlquiladoException</code></li>
<li><code>CupoSuperadoException</code></li>
<li><code>SoporteNoEncontradoException</code></li>
<li><code>ClienteNoEncontradoException</code></li>
</ul>
</li>
<li>En <code>Cliente</code>, modifica los métodos <code>alquilar</code> y <code>devolver</code>, para que hagan uso de las nuevas excepciones (lanzándolas cuando sea necesario) y funcionen como métodos encadenados. Destacar que estos métodos, no se capturar estás excepciones, sólo se lanzan.
En <code>Videoclub</code>, modifica <code>alquilarSocioProducto</code> para capturar todas las excepciones que ahora lanza <code>Cliente</code> e informar al usuario en consecuencia.</li>
<li>Vamos a modificar el proyecto para que el videoclub sepa qué productos están o no alquilados:<ul>
<li>En <code>Soporte</code>, crea una propiedad pública cuyo nombre sea <code>alquilado</code> que inicialmente estará a <code>false</code>. Cuando se alquile, se pondrá a <code>true</code>. Al devolver, la volveremos a poner a <code>false</code>.</li>
<li>En <code>Videoclub</code>, crea dos nuevas propiedades y sus getters:<ul>
<li><code>numProductosAlquilados</code></li>
<li><code>numTotalAlquileres</code></li>
</ul>
</li>
</ul>
</li>
<li>Crea un nuevo método en <code>Videoclub</code> llamado <code>alquilarSocioProductos(int numCliente, array numerosSoportes)</code>, el cual debe recibir un array con los números de productos a alquilar.<br />
Antes de alquilarlos, debe comprobar que todos los soportes estén disponibles, de manera que si uno no lo está, no se le alquile ninguno.</li>
<li>
<p>Crea dos nuevos métodos en <code>Videoclub</code>, y mediante la definición, deduce qué deben realizar:</p>
<ul>
<li><code>devolverSocioProducto(int numCliente, int numeroSoporte)</code></li>
<li><code>devolverSocioProductos(int numCliente, array numerosSoportes)</code></li>
</ul>
<p>Deben soportar el encadenamiento de métodos.
Recuerda actualizar la propiedad <code>alquilado</code> de Soporte.</p>
</li>
</ol>
<p>Cuando hayas realizado todos los ejercicios, crea una etiqueta mediante <code>git tag</code> con el nombre <code>v0.337</code> y sube los cambios a GitHub.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2025-2026 Eladio Blanco. Licencia CC BY-NC-SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/eladioblanco" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.2 4.2 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.52 8.52 0 0 1-5.33 1.84q-.51 0-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:<eladio.blanco@fernando3martos.com>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 12.13c-.15.01-.29.06-.39.17l-1 1 2.05 2 1-1c.22-.21.22-.56 0-.77l-1.24-1.23a.56.56 0 0 0-.38-.17m-2 1.75L13 19.94V22h2.06l6.06-6.07M20 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h7v-.89l8.24-8.22c.47-.49 1.12-.76 1.8-.76.34 0 .68.06 1 .19V6c0-1.12-.92-2-2.04-2m0 4-8 5-8-5V6l8 5 8-5"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": ".", "features": ["header.autohide", "toc.integrate", "content.tabs.link"], "search": "assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>